/*! For license information please see file-request-and-setting-modal~file-request-builder~file-request-preview~preview-components~uploads-~c532822c.4e2da8408a.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([["file-request-and-setting-modal~file-request-builder~file-request-preview~preview-components~uploads-~c532822c"],{"03vecjQMf5":function(e,t,r){"use strict";var n=r("BSXSWhc9DH");function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.memoryStore=new n.a,this.localStorage=window.localStorage,this.isLocalStorageAvailable=this.canUseLocalStorage()}var t,r,i;return t=e,(r=[{key:"buildKey",value:function(e){return"".concat("localStore","/").concat("0","/").concat(e)}},{key:"canUseLocalStorage",value:function(){if(!this.localStorage)return!1;try{return this.localStorage.setItem(this.buildKey("TestKey"),"testValue"),this.localStorage.removeItem(this.buildKey("TestKey")),!0}catch(e){return!1}}},{key:"setItem",value:function(e,t){if(this.isLocalStorageAvailable)try{this.localStorage.setItem(this.buildKey(e),JSON.stringify(t))}catch(e){}else this.memoryStore.set(e,t)}},{key:"getItem",value:function(e){if(!this.isLocalStorageAvailable)return this.memoryStore.get(e);try{var t=this.localStorage.getItem(this.buildKey(e));return t?JSON.parse(t):null}catch(e){return null}}},{key:"removeItem",value:function(e){if(this.isLocalStorageAvailable)try{this.localStorage.removeItem(this.buildKey(e))}catch(e){}else this.memoryStore.unset(e)}}])&&o(t.prototype,r),i&&o(t,i),e}();t.a=i},"3iqZJKdelp":function(e,t,r){"use strict";var n=r("vN+2IcUykn"),o=r.n(n),i=r("vDqi2OZMyG"),a=r.n(i),s=r("mwIZSSbMl2"),c=r.n(s),u=r("ijCdHo2SAB"),l=r.n(u),f=r("aAZChApN2+"),p=r.n(f),h=r("vVaM4hVnXJ"),d=r("8Wpvjplx0g");function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var E=[d.HTTP_GET,d.HTTP_OPTIONS,d.HTTP_HEAD].map(p.a),O=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.id,o=r.clientName,i=r.language,s=r.token,u=r.version,l=r.sharedLink,f=r.sharedLinkPassword,p=r.responseInterceptor,h=r.requestInterceptor,y=r.retryableStatusCodes,b=void 0===y?[d.HTTP_STATUS_CODE_RATE_LIMIT]:y,m=r.shouldRetry,g=void 0===m||m;v(this,e),_(this,"retryCount",0),_(this,"errorInterceptor",(function(e){if(t.shouldRetryRequest(e)){t.retryCount+=1;var r=t.getExponentialRetryTimeoutInMs(t.retryCount);return new Promise((function(n,o){t.retryTimeout=setTimeout((function(){t.axios(e.config).then(n,o)}),r)}))}var n=c()(e,"response.data")||e;return t.responseInterceptor(n),Promise.reject(e)})),this.clientName=o,this.id=n,this.language=i,this.responseInterceptor=p||this.defaultResponseInterceptor,this.retryableStatusCodes=b,this.sharedLink=l,this.sharedLinkPassword=f,this.shouldRetry=g,this.token=s,this.version=u,this.axios=a.a.create(),this.axiosSource=a.a.CancelToken.source(),this.axios.interceptors.response.use(this.responseInterceptor,this.errorInterceptor),"function"===typeof h&&this.axios.interceptors.request.use(h)}var t,r,n,o,i;return t=e,(r=[{key:"defaultResponseInterceptor",value:function(e){return e}},{key:"shouldRetryRequest",value:function(e){if(!this.shouldRetry||this.retryCount>=3)return!1;var t=e.response,r=e.request,n=e.config,o=c()(t,"status"),i=c()(n,"method"),a=r&&!t,s=o===d.HTTP_STATUS_CODE_RATE_LIMIT,u=l()(this.retryableStatusCodes,o)&&l()(E,i);return a||s||u}},{key:"getExponentialRetryTimeoutInMs",value:function(e){var t=Math.ceil(1e3*Math.random());return 1e3*Math.pow(2,e-1)+t}},{key:"getParsedUrl",value:function(e){var t=document.createElement("a");return t.href=e,{api:e.replace("".concat(t.origin,"/2.0"),""),host:t.host,hostname:t.hostname,pathname:t.pathname,origin:t.origin,protocol:t.protocol,hash:t.hash,port:t.port}}},{key:"getHeaders",value:(o=regeneratorRuntime.mark((function e(t){var r,n,o,i,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},n=b(_({Accept:"application/json"},d.HEADER_CONTENT_TYPE,"application/json"),r),this.language&&!n[d.HEADER_ACCEPT_LANGUAGE]&&(n[d.HEADER_ACCEPT_LANGUAGE]=this.language),this.sharedLink&&(n.BoxApi="shared_link=".concat(this.sharedLink),this.sharedLinkPassword&&(n.BoxApi="".concat(n.BoxApi,"&shared_link_password=").concat(this.sharedLinkPassword))),this.clientName&&(n[d.HEADER_CLIENT_NAME]=this.clientName),this.version&&(n[d.HEADER_CLIENT_VERSION]=this.version),o=t||this.id||"",e.next=9,h.a.getWriteToken(o,this.token);case 9:return(i=e.sent)&&(n.Authorization="Bearer ".concat(i)),e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})),i=function(){var e=this,t=arguments;return new Promise((function(r,n){var i=o.apply(e,t);function a(e){m(i,r,n,a,s,"next",e)}function s(e){m(i,r,n,a,s,"throw",e)}a(void 0)}))},function(e){return i.apply(this,arguments)})},{key:"get",value:function(e){var t=this,r=e.url,n=e.id,o=e.params,i=void 0===o?{}:o,a=e.headers,s=void 0===a?{}:a;return this.getHeaders(n,s).then((function(e){return t.axios.get(r,{cancelToken:t.axiosSource.token,params:i,headers:e,parsedUrl:t.getParsedUrl(r)})}))}},{key:"post",value:function(e){var t=this,r=e.url,n=e.id,o=e.data,i=e.params,a=e.headers,s=void 0===a?{}:a,c=e.method,u=void 0===c?d.HTTP_POST:c;return this.getHeaders(n,s).then((function(e){return t.axios({url:r,data:o,params:i,method:u,parsedUrl:t.getParsedUrl(r),headers:e})}))}},{key:"put",value:function(e){var t=e.url,r=e.id,n=e.data,o=e.params,i=e.headers,a=void 0===i?{}:i;return this.post({id:r,url:t,data:n,params:o,headers:a,method:d.HTTP_PUT})}},{key:"delete",value:function(e){var t=e.url,r=e.id,n=e.data,o=void 0===n?{}:n,i=e.headers,a=void 0===i?{}:i;return this.post({id:r,url:t,data:o,headers:a,method:d.HTTP_DELETE})}},{key:"options",value:function(e){var t=this,r=e.id,n=e.url,o=e.data,i=e.headers,a=void 0===i?{}:i,s=e.successHandler,c=e.errorHandler;return this.getHeaders(r,a).then((function(e){return t.axios({url:n,data:o,method:d.HTTP_OPTIONS,headers:e}).then(s).catch(c)})).catch(c)}},{key:"uploadFile",value:function(e){var t=this,r=e.id,n=e.url,o=e.data,i=e.headers,a=void 0===i?{}:i,s=e.method,c=void 0===s?d.HTTP_POST:s,u=e.successHandler,l=e.errorHandler,f=e.progressHandler,p=e.withIdleTimeout,h=void 0!==p&&p,y=e.idleTimeoutDuration,b=void 0===y?12e4:y,m=e.idleTimeoutHandler;return this.getHeaders(r,a).then((function(e){var r,i=f;if(h){var s=function(){t.abort(),m&&m()};r=setTimeout(s,b),i=function(e){clearTimeout(r),r=setTimeout(s,b),f(e)}}t.axios({url:n,data:o,transformRequest:function(e,t){if(delete t[d.HEADER_ACCEPT],delete t[d.HEADER_CONTENT_TYPE],a[d.HEADER_CONTENT_TYPE]&&(t[d.HEADER_CONTENT_TYPE]=a[d.HEADER_CONTENT_TYPE]),e&&!(e instanceof Blob)&&e.attributes){var r=new FormData;return Object.keys(e).forEach((function(t){r.append(t,e[t])})),r}return e},method:c,headers:e,onUploadProgress:i,cancelToken:t.axiosSource.token}).then((function(e){clearTimeout(r),u(e)})).catch((function(e){clearTimeout(r),l(e)}))})).catch(l)}},{key:"abort",value:function(){this.retryTimeout&&clearTimeout(this.retryTimeout),this.axiosSource&&(this.axiosSource.cancel(),this.axiosSource=a.a.CancelToken.source())}}])&&g(t.prototype,r),n&&g(t,n),e}(),k=r("BSXSWhc9DH"),C=r("a2jX1cNsCJ"),P=r("fn3w3TIrL6");function w(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var R=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),T(this,"successHandler",(function(e){r.isDestroyed()||"function"!==typeof r.successCallback||r.successCallback(e)})),T(this,"errorHandler",(function(e){if(!r.isDestroyed()&&"function"===typeof r.errorCallback){var t=e.response;t&&t.data?r.errorCallback(t.data,r.errorCode):r.errorCallback(e,r.errorCode)}})),this.cache=t.cache||new k.a,this.apiHost=t.apiHost||d.DEFAULT_HOSTNAME_API,this.uploadHost=t.uploadHost||d.DEFAULT_HOSTNAME_UPLOAD,this.options=A({},t,{apiHost:this.apiHost,uploadHost:this.uploadHost,cache:this.cache}),this.xhr=new O(this.options),this.destroyed=!1,this.consoleLog=t.consoleLog&&window.console&&window.console.log||o.a,this.consoleError=t.consoleError&&window.console&&window.console.error||o.a}var t,r,n,i,a;return t=e,(r=[{key:"destroy",value:function(){this.xhr.abort(),this.destroyed=!0}},{key:"isDestroyed",value:function(){return this.destroyed}},{key:"checkApiCallValidity",value:function(e,t,r){if(!r||!t)throw Object(P.a)();if(!t[e])throw Object(P.b)()}},{key:"getBaseApiUrl",value:function(){var e=this.apiHost.endsWith("/")?"2.0":"/2.0";return"".concat(this.apiHost).concat(e)}},{key:"getBaseUploadUrl",value:function(){var e=this.uploadHost.endsWith("/")?"api/2.0":"/api/2.0";return"".concat(this.uploadHost).concat(e)}},{key:"getCache",value:function(){return this.cache}},{key:"getUrl",value:function(e){throw new Error("Implement me!")}},{key:"format",value:function(e){throw new Error("Implement me!")}},{key:"get",value:function(e){var t=e.id,r=e.successCallback,n=e.errorCallback,o=e.requestData,i=e.url||this.getUrl(t);return this.makeRequest(d.HTTP_GET,t,i,r,n,o)}},{key:"post",value:function(e){var t=e.id,r=e.url,n=e.data,o=e.successCallback,i=e.errorCallback;return this.makeRequest(d.HTTP_POST,t,r,o,i,n)}},{key:"put",value:function(e){var t=e.id,r=e.url,n=e.data,o=e.successCallback,i=e.errorCallback;return this.makeRequest(d.HTTP_PUT,t,r,o,i,n)}},{key:"delete",value:function(e){var t=e.id,r=e.url,n=e.data,o=e.successCallback,i=e.errorCallback;return this.makeRequest(d.HTTP_DELETE,t,r,o,i,n)}},{key:"makeRequest",value:(i=regeneratorRuntime.mark((function e(t,r,n,o,i){var a,s,c,u,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=l.length>5&&void 0!==l[5]?l[5]:{},!this.isDestroyed()){e.next=3;break}return e.abrupt("return");case 3:return this.successCallback=o,this.errorCallback=i,s=this.xhr[t.toLowerCase()].bind(this.xhr),e.prev=6,e.next=9,s(A({id:Object(C.getTypedFileId)(r),url:n},a));case 9:c=e.sent,u=c.data,this.successHandler(u),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),this.errorHandler(e.t0);case 17:case"end":return e.stop()}}),e,this,[[6,14]])})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function a(e){w(o,r,n,a,s,"next",e)}function s(e){w(o,r,n,a,s,"throw",e)}a(void 0)}))},function(e,t,r,n,o){return a.apply(this,arguments)})}])&&I(t.prototype,r),n&&I(t,n),e}();t.a=R},"4qC0uLa34A":function(e,t,r){var n=r("NykKPXtg8B"),o=r("Z0cmtJMNoo"),i=r("ExA7XOIq4Z");e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==n(e)}},"5mCW88DpfN":function(e,t,r){"use strict";var n=r("k1oiGGP5HG"),o=r("8Wpvjplx0g"),i=r("7EA+m7Wkjh");function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=function(e){function t(){return c(this,t),l(this,f(t).apply(this,arguments))}var r,n,a,h,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,e),r=t,(n=[{key:"getCacheKey",value:function(e){return"".concat(o.CACHE_PREFIX_WEBLINK).concat(e)}},{key:"getUrl",value:function(e){var t=e?"/".concat(e):"";return"".concat(this.getBaseApiUrl(),"/web_links").concat(t)}},{key:"getWeblink",value:(h=regeneratorRuntime.mark((function e(t,r,n){var a,s,c,u,l,f,p,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>3&&void 0!==h[3]?h[3]:{},s=a.fields,!this.isDestroyed()){e.next=3;break}return e.abrupt("return");case 3:if(c=this.getCache(),u=this.getCacheKey(t),this.errorCode=o.ERROR_CODE_FETCH_WEBLINK,this.successCallback=r,this.errorCallback=n,!c.has(u)){e.next=13;break}if(0!==Object(i.i)(c.get(u),s).length){e.next=13;break}return r(c.get(u)),e.abrupt("return");case 13:return l={url:this.getUrl(t)},s&&(l.params={fields:s.toString()}),e.prev=15,e.next=18,this.xhr.get(l);case 18:if(f=e.sent,p=f.data,!this.isDestroyed()){e.next=22;break}return e.abrupt("return");case 22:c.has(u)?c.merge(u,p):c.set(u,p),this.successHandler(c.get(u)),e.next=29;break;case 26:e.prev=26,e.t0=e.catch(15),this.errorHandler(e.t0);case 29:case"end":return e.stop()}}),e,this,[[15,26]])})),d=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=h.apply(e,t);function i(e){s(o,r,n,i,a,"next",e)}function a(e){s(o,r,n,i,a,"throw",e)}i(void 0)}))},function(e,t,r){return d.apply(this,arguments)})}])&&u(r.prototype,n),a&&u(r,a),t}(n.a);t.a=h},"7EA+m7Wkjh":function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return m})),r.d(t,"d",(function(){return y})),r.d(t,"c",(function(){return b})),r.d(t,"h",(function(){return _})),r.d(t,"i",(function(){return g})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return h}));var n=r("OFL0i0gLuj"),o=r.n(n),i=r("D1y2Gn20OY"),a=r.n(i),s=r("8Wpvjplx0g");function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=[s.FIELD_ID,s.FIELD_NAME,s.FIELD_TYPE,s.FIELD_SIZE,s.FIELD_PARENT,s.FIELD_EXTENSION,s.FIELD_PERMISSIONS,s.FIELD_PATH_COLLECTION,s.FIELD_MODIFIED_AT,s.FIELD_CREATED_AT,s.FIELD_MODIFIED_BY,s.FIELD_HAS_COLLABORATIONS,s.FIELD_IS_EXTERNALLY_OWNED,s.FIELD_ITEM_COLLECTION,s.FIELD_AUTHENTICATED_DOWNLOAD_URL,s.FIELD_IS_DOWNLOAD_AVAILABLE,s.FIELD_REPRESENTATIONS,s.FIELD_URL],h=[s.FIELD_ID,s.FIELD_NAME,s.FIELD_SIZE,s.FIELD_EXTENSION,s.FIELD_FILE_VERSION,s.FIELD_SHARED_LINK,s.FIELD_PERMISSIONS,s.FIELD_CONTENT_CREATED_AT,s.FIELD_CONTENT_MODIFIED_AT,s.FIELD_CREATED_AT,s.FIELD_CREATED_BY,s.FIELD_MODIFIED_AT,s.FIELD_MODIFIED_BY,s.FIELD_OWNED_BY,s.FIELD_DESCRIPTION,s.FIELD_METADATA_SKILLS,s.FIELD_ITEM_EXPIRATION,s.FIELD_VERSION_LIMIT,s.FIELD_VERSION_NUMBER,s.FIELD_IS_EXTERNALLY_OWNED,s.FIELD_RESTORED_FROM,s.FIELD_AUTHENTICATED_DOWNLOAD_URL,s.FIELD_IS_DOWNLOAD_AVAILABLE,s.FIELD_UPLOADER_DISPLAY_NAME],d=[s.FIELD_ID,s.FIELD_PERMISSIONS,s.FIELD_SHARED_LINK,s.FIELD_SHA1,s.FIELD_FILE_VERSION,s.FIELD_NAME,s.FIELD_SIZE,s.FIELD_EXTENSION,s.FIELD_REPRESENTATIONS,s.FIELD_WATERMARK_INFO,s.FIELD_AUTHENTICATED_DOWNLOAD_URL,s.FIELD_IS_DOWNLOAD_AVAILABLE],y=[s.FIELD_FILE_VERSION,s.FIELD_MODIFIED_AT,s.FIELD_MODIFIED_BY,s.FIELD_RESTORED_FROM,s.FIELD_SIZE,s.FIELD_UPLOADER_DISPLAY_NAME,s.FIELD_VERSION_NUMBER],b=[s.FIELD_AUTHENTICATED_DOWNLOAD_URL,s.FIELD_CREATED_AT,s.FIELD_EXTENSION,s.FIELD_IS_DOWNLOAD_AVAILABLE,s.FIELD_MODIFIED_AT,s.FIELD_MODIFIED_BY,s.FIELD_NAME,s.FIELD_PERMISSIONS,s.FIELD_RESTORED_AT,s.FIELD_RESTORED_BY,s.FIELD_RETENTION,s.FIELD_SIZE,s.FIELD_TRASHED_AT,s.FIELD_TRASHED_BY,s.FIELD_UPLOADER_DISPLAY_NAME,s.FIELD_VERSION_NUMBER],m=(s.FIELD_ALLOWED_SHARED_LINK_ACCESS_LEVELS,s.FIELD_SHARED_LINK,s.FIELD_TASK_ASSIGNMENT_COLLECTION,s.FIELD_IS_COMPLETED,s.FIELD_CREATED_AT,s.FIELD_CREATED_BY,s.FIELD_DUE_AT,s.FIELD_MESSAGE,s.FIELD_ASSIGNED_TO,s.FIELD_STATUS,[s.FIELD_TAGGED_MESSAGE,s.FIELD_MESSAGE,s.FIELD_CREATED_AT,s.FIELD_CREATED_BY,s.FIELD_MODIFIED_AT,s.FIELD_PERMISSIONS]),v=(s.FIELD_CREATED_BY,s.FIELD_MODIFIED_BY,s.FIELD_OWNED_BY,s.FIELD_ASSIGNED_TO,[s.FIELD_ACTIVITY_TEMPLATE,s.FIELD_APP,s.FIELD_CREATED_BY,s.FIELD_OCCURRED_AT,s.FIELD_RENDERED_TEXT]);function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e&&"object"===f(e)&&0!==Object.keys(e).length?t.filter((function(t){return!o()(e,t)})):t}function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(!Array.isArray(t)||0===t.length)return e;var r=u({},e),n=g(e,t);return n.forEach((function(e){a()(r,e,null)})),r}},"AkPpBUyl/w":function(e,t,r){"use strict";var n=r("BSXSWhc9DH"),o=r("FK3KWhmfP1"),i=r("vN+2IcUykn"),a=r.n(i),s=r("DUBYMsvOMy"),c=r("YrhTq/oyJV"),u=r("fh8xsLuPZu");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){f(i,n,o,a,s,"next",e)}function s(e){f(i,n,o,a,s,"throw",e)}a(void 0)}))}}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?m(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _=function(e){function t(){var e,r;h(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return g(m(r=y(this,(e=b(t)).call.apply(e,[this].concat(o)))),"uploadSuccessHandler",(function(e){var t=e.data.entries;r.isDestroyed()||"function"===typeof r.successCallback&&r.successCallback(t)})),g(m(r),"uploadProgressHandler",(function(e){r.isDestroyed()||"function"===typeof r.progressCallback&&r.progressCallback(e)})),g(m(r),"preflightSuccessHandler",function(){var e=p(regeneratorRuntime.mark((function e(t){var n,o,i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,!r.isDestroyed()){e.next=3;break}return e.abrupt("return");case 3:return(o=n.upload_url)||(o="".concat(r.getBaseUploadUrl(),"/files/content"),r.fileId&&(o=o.replace("content","".concat(r.fileId,"/content")))),i=JSON.stringify({name:r.fileName,parent:{id:r.folderId},description:r.fileDescription,content_modified_at:Object(c.getFileLastModifiedAsISONoMSIfPossible)(r.file)}),a={url:o,data:{attributes:i,file:r.file},headers:{},successHandler:r.uploadSuccessHandler,errorHandler:r.preflightErrorHandler,progressHandler:r.uploadProgressHandler},e.next=9,r.computeSHA1(r.file);case 9:(s=e.sent)&&(a.headers=g({},"Content-MD5",s)),r.xhr.uploadFile(a);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r}var r,n,o,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,e),r=t,(n=[{key:"upload",value:function(e){var t=e.folderId,r=e.fileId,n=e.file,o=e.fileDescription,i=e.successCallback,s=void 0===i?a.a:i,c=e.errorCallback,u=void 0===c?a.a:c,l=e.progressCallback,f=void 0===l?a.a:l,p=e.conflictCallback,h=e.overwrite,d=void 0===h||h;this.isDestroyed()||(this.folderId=t,this.fileId=r,this.file=n,this.fileDescription=o,this.fileName=this.file.name,this.successCallback=s,this.errorCallback=u,this.progressCallback=f,this.overwrite=d,this.conflictCallback=p,this.makePreflightRequest())}},{key:"cancel",value:function(){this.isDestroyed()||(clearTimeout(this.retryTimeout),this.destroy())}},{key:"computeSHA1",value:(i=p(regeneratorRuntime.mark((function e(t){var r,n,o,i,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.prev=1,n=new window.FileReader,e.next=5,this.readFile(n,t);case 5:return o=e.sent,i=o.buffer,e.next=9,Object(s.a)("SHA-1",i);case 9:a=e.sent,c=Array.from(new Uint8Array(a)),r=c.map((function(e){return"00".concat(e.toString(16)).slice(-2)})).join(""),e.next=16;break;case 14:e.prev=14,e.t0=e.catch(1);case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this,[[1,14]])}))),function(e){return i.apply(this,arguments)})}])&&d(r.prototype,n),o&&d(r,o),t}(u.a),E=r("VqrN+CpLF1"),O=r("dEgP6Cehtk"),k=r("5mCW88DpfN"),C=r("PRoclJX2va"),P=r("7EA+m7Wkjh"),w=r("fn3w3TIrL6"),S=r("3iqZJKdelp"),A=r("8Wpvjplx0g");function I(e){return(I="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){H(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t){return!t||"object"!==I(t)&&"function"!==typeof t?F(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var M=function(e){function t(){var e,r;D(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return H(F(r=x(this,(e=L(t)).call.apply(e,[this].concat(o)))),"searchSuccessHandler",(function(e){var t=e.data;if(!r.isDestroyed()){var n=t.entries,o=t.total_count,i=t.limit,a=t.offset;if(!Array.isArray(n)||"number"!==typeof o||"number"!==typeof i||"number"!==typeof a)throw Object(w.a)();var s=Object(C.a)(n,new E.a(r.options),new O.a(r.options),new k.a(r.options));r.itemCache=(r.itemCache||[]).concat(s),r.getCache().set(r.key,{item_collection:R({},t,{entries:r.itemCache})}),r.finish()}})),H(F(r),"searchErrorHandler",(function(e){r.isDestroyed()||r.errorCallback(e,r.errorCode)})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),r=t,(n=[{key:"getEncodedQuery",value:function(e){return encodeURIComponent(e)}},{key:"getCacheKey",value:function(e,t){return"".concat(A.CACHE_PREFIX_SEARCH).concat(e,"|").concat(t)}},{key:"getUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/search")}},{key:"isLoaded",value:function(){return this.getCache().has(this.key)}},{key:"finish",value:function(){if(!this.isDestroyed()){var e=this.getCache(),t=e.get(this.key).item_collection;if(!t)throw Object(w.a)();var r=t.entries,n=t.total_count;if(!Array.isArray(r)||"number"!==typeof n)throw Object(w.a)();var o={id:this.id,items:r.map((function(t){return e.get(t)})),offset:this.offset,percentLoaded:100,sortBy:A.FIELD_RELEVANCE,sortDirection:A.SORT_DESC,totalCount:n};this.successCallback(o)}}},{key:"searchRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isDestroyed())return Promise.reject();var t=e.fields,r=t||P.e;return this.errorCode=A.ERROR_CODE_SEARCH,this.xhr.get({url:this.getUrl(),params:{offset:this.offset,query:this.query,ancestor_folder_ids:this.id,limit:this.limit,fields:r.toString()},headers:r.includes(A.FIELD_REPRESENTATIONS)?{"X-Rep-Hints":A.X_REP_HINT_HEADER_DIMENSIONS_DEFAULT}:{}}).then(this.searchSuccessHandler).catch(this.searchErrorHandler)}},{key:"search",value:function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.isDestroyed()||(this.limit=r,this.offset=n,this.query=t,this.id=e,this.key=this.getCacheKey(e,this.getEncodedQuery(this.query)),this.successCallback=o,this.errorCallback=i,a.forceFetch&&this.getCache().unset(this.key),this.isLoaded()?this.finish():this.searchRequest(a))}}])&&j(r.prototype,n),o&&j(r,o),t}(S.a);function U(e){return(U="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function K(e,t){return!t||"object"!==U(t)&&"function"!==typeof t?G(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Y=function(e){function t(){var e,r;X(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return J(G(r=K(this,(e=W(t)).call.apply(e,[this].concat(o)))),"recentsSuccessHandler",(function(e){var t=e.data;if(!r.isDestroyed()){var n=t.entries,o=t.order,i=o.by,a=o.direction,s=[];n.forEach((function(e){var t=e.item,n=e.interacted_at,o=t.path_collection;(r.id===A.DEFAULT_ROOT||!!o&&-1!==o.entries.findIndex((function(e){return e.id===r.id})))&&s.push(B(t,{interacted_at:n}))}));var c=Object(C.a)(s,new E.a(r.options),new O.a(r.options),new k.a(r.options));r.getCache().set(r.key,{item_collection:{entries:c,order:[{by:i,direction:a}]}}),r.finish()}})),J(G(r),"recentsErrorHandler",(function(e){r.isDestroyed()||r.errorCallback(e,r.errorCode)})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,e),r=t,(n=[{key:"getCacheKey",value:function(e){return"".concat(A.CACHE_PREFIX_RECENTS).concat(e)}},{key:"getUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/recent_items")}},{key:"finish",value:function(){if(!this.isDestroyed()){var e=this.getCache(),t=e.get(this.key).item_collection;if(!t)throw Object(w.a)();var r=t.entries;if(!Array.isArray(r))throw Object(w.a)();var n={id:this.id,items:r.map((function(t){return e.get(t)})),percentLoaded:100,sortBy:A.FIELD_DATE,sortDirection:A.SORT_DESC};this.successCallback(n)}}},{key:"recentsRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isDestroyed())return Promise.reject();var t=e.fields,r=t||P.e;return this.errorCode=A.ERROR_CODE_FETCH_RECENTS,this.xhr.get({url:this.getUrl(),params:{fields:r.toString()},headers:r.includes(A.FIELD_REPRESENTATIONS)?{"X-Rep-Hints":A.X_REP_HINT_HEADER_DIMENSIONS_DEFAULT}:{}}).then(this.recentsSuccessHandler).catch(this.recentsErrorHandler)}},{key:"recents",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.isDestroyed()){this.id=e,this.successCallback=t,this.errorCallback=r;var o=this.getCache();this.key=this.getCacheKey(this.id),n.forceFetch&&o.unset(this.key),o.has(this.key)?this.finish():this.recentsRequest(n)}}}])&&q(r.prototype,n),o&&q(r,o),t}(S.a),z=r("mwIZSSbMl2"),Q=r.n(z),Z=r("a2jX1cNsCJ");function $(e){return($="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){re(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function re(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ne(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function oe(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ne(i,n,o,a,s,"next",e)}function s(e){ne(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function se(e,t){return!t||"object"!==$(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var le=function(e){function t(){return ie(this,t),se(this,ce(t).apply(this,arguments))}var r,n,o,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(t,e),r=t,(n=[{key:"getQueryParameters",value:function(e,t,r){var n={offset:e,limit:t};return r&&r.length>0&&(n.fields=r.toString()),n}},{key:"hasMoreItems",value:function(e,t){return void 0===t||e<t}},{key:"offsetGetRequest",value:(a=oe(regeneratorRuntime.mark((function e(t,r,n,o,i){var a,s,c,u,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDestroyed()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a=this.getQueryParameters(r,n,i),s=this.getUrl(t),e.next=7,this.xhr.get({url:s,id:Object(Z.getTypedFileId)(t),params:a});case 7:if(c=e.sent,u=c.data,l=this.data?this.data.entries:[],this.data=te({},u,{entries:l.concat(u.entries)}),f=u.total_count,p=r+n,!o||!this.hasMoreItems(p,f)){e.next=16;break}return this.offsetGetRequest(t,p,n,o,i),e.abrupt("return");case 16:this.successHandler(this.data),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),this.errorHandler(e.t0);case 22:case"end":return e.stop()}}),e,this,[[2,19]])}))),function(e,t,r,n,o){return a.apply(this,arguments)})},{key:"offsetGet",value:(i=oe(regeneratorRuntime.mark((function e(t,r,n){var o,i,a,s,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.length>3&&void 0!==c[3]?c[3]:A.DEFAULT_FETCH_START,i=c.length>4&&void 0!==c[4]?c[4]:A.DEFAULT_FETCH_END,a=c.length>5?c[5]:void 0,s=!(c.length>6&&void 0!==c[6])||c[6],this.successCallback=r,this.errorCallback=n,e.abrupt("return",this.offsetGetRequest(t,o,i,s,a));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return i.apply(this,arguments)})}])&&ae(r.prototype,n),o&&ae(r,o),t}(S.a);function fe(e){return(fe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pe(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){Oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ye(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ve(e,t){return!t||"object"!==fe(t)&&"function"!==typeof t?_e(e):t}function ge(e){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ke=function(e){function t(){var e,r;be(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Oe(_e(r=ve(this,(e=ge(t)).call.apply(e,[this].concat(o)))),"successHandler",(function(e){r.isDestroyed()||"function"!==typeof r.successCallback||r.successCallback(e)})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(e){if(!e)throw new Error("Missing file id!");return"".concat(this.getBaseApiUrl(),"/files/").concat(e,"/versions")}},{key:"getVersionUrl",value:function(e,t){if(!t)throw new Error("Missing version id!");return"".concat(this.getUrl(e),"/").concat(t)}},{key:"addPermissions",value:function(e,t){if(!e)return e;var r=e.entries,n=e.total_count,o=Q()(t,["permissions",A.PERMISSION_CAN_UPLOAD],!1);return{entries:r.map((function(e){var t=e.permissions;return de({},ye(e,["permissions"]),{permissions:de({can_upload:o},t)})})),total_count:n}}},{key:"deleteVersion",value:function(e){var t=e.errorCallback,r=e.fileId,n=e.permissions,o=e.successCallback,i=e.versionId;this.errorCode=A.ERROR_CODE_DELETE_VERSION;try{this.checkApiCallValidity(A.PERMISSION_CAN_DELETE,n,r)}catch(e){return void t(e,this.errorCode)}this.delete({id:r,url:this.getVersionUrl(r,i),successCallback:o,errorCallback:t})}},{key:"getVersions",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:A.DEFAULT_FETCH_START,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:A.DEFAULT_FETCH_END,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:P.c,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.errorCode=A.ERROR_CODE_FETCH_VERSIONS,this.offsetGet(e,t,r,n,o,i,a)}},{key:"getVersion",value:function(e,t,r,n){this.errorCode=A.ERROR_CODE_FETCH_VERSION,this.get({id:e,successCallback:r,errorCallback:n,url:this.getVersionUrl(e,t),requestData:{params:{fields:P.c.toString()}}})}},{key:"addCurrentVersion",value:function(e,t,r){if(!e)return t||{entries:[],total_count:0};if(!t)return{entries:[e],total_count:1};var n=Q()(r,"restored_from.id"),o=t.entries.find((function(e){return e.id===n}));return o&&(e.version_promoted=o.version_number),{entries:[].concat(pe(t.entries),[e]),total_count:t.total_count+1}}},{key:"promoteVersion",value:function(e){var t=e.errorCallback,r=e.fileId,n=e.permissions,o=e.successCallback,i=e.versionId;this.errorCode=A.ERROR_CODE_PROMOTE_VERSION;try{this.checkApiCallValidity(A.PERMISSION_CAN_UPLOAD,n,r)}catch(e){return void t(e,this.errorCode)}this.post({id:r,data:{data:{id:i,type:"file_version"}},url:this.getVersionUrl(r,"current"),successCallback:o,errorCallback:t})}},{key:"restoreVersion",value:function(e){var t=e.errorCallback,r=e.fileId,n=e.permissions,o=e.successCallback,i=e.versionId;this.errorCode=A.ERROR_CODE_RESTORE_VERSION;try{this.checkApiCallValidity(A.PERMISSION_CAN_DELETE,n,r)}catch(e){return void t(e,this.errorCode)}this.put({id:r,data:{data:{trashed_at:null}},url:this.getVersionUrl(r,i),successCallback:o,errorCallback:t})}}])&&me(r.prototype,n),o&&me(r,o),t}(le);function Ce(e){return(Ce="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function we(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(r),!0).forEach((function(t){je(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e,t){return!t||"object"!==Ce(t)&&"function"!==typeof t?Re(e):t}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function De(e,t){return(De=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var xe=function(e){function t(){var e,r;Se(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return je(Re(r=Ie(this,(e=Te(t)).call.apply(e,[this].concat(o)))),"successHandler",(function(e){if(!r.isDestroyed()&&"function"===typeof r.successCallback)if(e)if(e.entries){var t=e.entries.map(r.format);r.successCallback(we({},e,{entries:t}))}else r.successCallback(r.format(e));else r.successCallback()})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&De(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(e){if(!e)throw new Error("Missing file id!");return"".concat(this.getBaseApiUrl(),"/files/").concat(e,"/comments")}},{key:"commentsUrl",value:function(e){var t="".concat(this.getBaseApiUrl(),"/comments");return e?"".concat(t,"/").concat(e):t}},{key:"format",value:function(e){return we({},e,{tagged_message:""!==e.tagged_message?e.tagged_message:e.message})}},{key:"createComment",value:function(e){var t=e.file,r=e.message,n=e.taggedMessage,o=e.successCallback,i=e.errorCallback;this.errorCode=A.ERROR_CODE_CREATE_COMMENT;var a=t.id,s=void 0===a?"":a,c=t.permissions;try{this.checkApiCallValidity(A.PERMISSION_CAN_COMMENT,c,s)}catch(e){return void i(e,this.errorCode)}var u={data:{item:{id:s,type:"file"},message:r,tagged_message:n},params:{fields:P.b.toString()}};this.post({id:s,url:this.commentsUrl(),data:u,successCallback:o,errorCallback:i})}},{key:"updateComment",value:function(e){var t=e.file,r=e.commentId,n=e.message,o=e.tagged_message,i=e.permissions,a=e.successCallback,s=e.errorCallback;this.errorCode=A.ERROR_CODE_UPDATE_COMMENT;var c=t.id,u=void 0===c?"":c;try{this.checkApiCallValidity(A.PERMISSION_CAN_EDIT,i,u)}catch(e){return void s(e,this.errorCode)}var l={data:{message:n,tagged_message:o}};this.put({id:u,url:this.commentsUrl(r),data:l,successCallback:a,errorCallback:s})}},{key:"deleteComment",value:function(e){var t=e.file,r=e.commentId,n=e.permissions,o=e.successCallback,i=e.errorCallback;this.errorCode=A.ERROR_CODE_DELETE_COMMENT;var a=t.id,s=void 0===a?"":a;try{this.checkApiCallValidity(A.PERMISSION_CAN_DELETE,n,s)}catch(e){return void i(e,this.errorCode)}this.delete({id:s,url:this.commentsUrl(r),successCallback:o,errorCallback:i})}},{key:"getComments",value:function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:P.b,i=arguments.length>5?arguments[5]:void 0,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0;this.errorCode=A.ERROR_CODE_FETCH_COMMENTS;try{this.checkApiCallValidity(A.PERMISSION_CAN_COMMENT,t,e)}catch(e){return void n(e,this.errorCode)}this.offsetGet(e,r,n,i,a,o,s)}}])&&Ae(r.prototype,n),o&&Ae(r,o),t}(le);function Le(e){return(Le="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function He(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Me(e,t){return!t||"object"!==Le(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Be(e,t){return(Be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xe=[A.HTTP_STATUS_CODE_RATE_LIMIT,A.HTTP_STATUS_CODE_INTERNAL_SERVER_ERROR,A.HTTP_STATUS_CODE_NOT_IMPLEMENTED,A.HTTP_STATUS_CODE_BAD_GATEWAY,A.HTTP_STATUS_CODE_SERVICE_UNAVAILABLE,A.HTTP_STATUS_CODE_GATEWAY_TIMEOUT],qe=function(e){function t(e){var r=e.retryableStatusCodes,n=void 0===r?Xe:r,o=He(e,["retryableStatusCodes"]);return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Me(this,Ue(t).call(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(r),!0).forEach((function(t){Ne(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},o,{retryableStatusCodes:n})))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Be(e,t)}(t,e),t}(S.a);function Ke(e){return(Ke="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach((function(t){Ve(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ye(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ze(e,t){return!t||"object"!==Ke(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qe(e){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $e=function(e){function t(){return Je(this,t),ze(this,Qe(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(t,e),r=t,(n=[{key:"getUrlForFileTasks",value:function(e){return"".concat(this.getBaseApiUrl(),"/undoc/files/").concat(e,"/linked_tasks?limit=").concat(A.API_PAGE_LIMIT)}},{key:"getUrlForTaskCreate",value:function(){return"".concat(this.getBaseApiUrl(),"/undoc/tasks")}},{key:"getUrlForTask",value:function(e){return"".concat(this.getBaseApiUrl(),"/undoc/tasks/").concat(e)}},{key:"createTask",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task;this.errorCode=A.ERROR_CODE_CREATE_TASK,this.post({id:r.id,url:this.getUrlForTaskCreate(),data:{data:Ge({},o)},successCallback:n,errorCallback:t})}},{key:"updateTask",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task;this.errorCode=A.ERROR_CODE_UPDATE_TASK,this.put({id:r.id,url:this.getUrlForTask(o.id),data:{data:Ge({},o)},successCallback:n,errorCallback:t})}},{key:"deleteTask",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task;this.errorCode=A.ERROR_CODE_DELETE_TASK,this.delete({id:r.id,url:this.getUrlForTask(o.id),successCallback:n,errorCallback:t})}},{key:"getTasksForFile",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback;this.errorCode=A.ERROR_CODE_FETCH_TASKS,this.get({id:r.id,url:this.getUrlForFileTasks(r.id),successCallback:n,errorCallback:t})}},{key:"getTask",value:function(e){var t=e.errorCallback,r=e.file,n=e.id,o=e.successCallback;this.errorCode=A.ERROR_CODE_FETCH_TASKS,this.get({id:r.id,url:this.getUrlForTask(n),successCallback:o,errorCallback:t})}}])&&Ye(r.prototype,n),o&&Ye(r,o),t}(qe),et=r("PuqeRHPhsD"),tt=r.n(et);function rt(e){return(rt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ot(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(r),!0).forEach((function(t){it(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function it(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ct(e,t){return!t||"object"!==rt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ut(e){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ft=function(e){function t(){return at(this,t),ct(this,ut(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(t,e),r=t,(n=[{key:"getUrlForTaskCollaborators",value:function(e){return"".concat(this.getBaseApiUrl(),"/undoc/tasks/").concat(e,"/task_collaborators?role=ASSIGNEE&limit=").concat(A.API_PAGE_LIMIT)}},{key:"getUrlForTaskCollaboratorCreate",value:function(){return"".concat(this.getBaseApiUrl(),"/undoc/task_collaborators")}},{key:"getUrlForTaskCollaborator",value:function(e){return"".concat(this.getBaseApiUrl(),"/undoc/task_collaborators/").concat(e)}},{key:"getUrlForTaskGroupCreate",value:function(){return"".concat(this.getBaseApiUrl(),"/undoc/task_collaborators/expand_group")}},{key:"createTaskCollaborator",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task,i=e.user;this.errorCode=A.ERROR_CODE_CREATE_TASK_COLLABORATOR;var a={data:{task:{type:"task",id:o.id},target:{type:"user",id:i.id}}};this.post({id:r.id,url:this.getUrlForTaskCollaboratorCreate(),data:ot({},a),successCallback:n,errorCallback:t})}},{key:"createTaskCollaboratorsforGroup",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task,i=e.group;this.errorCode=A.ERROR_CODE_CREATE_TASK_COLLABORATOR;var a={data:{task:{type:"task",id:o.id},target:{type:"group",id:i.id}}};this.post({id:r.id,url:this.getUrlForTaskGroupCreate(),data:ot({},a),successCallback:n,errorCallback:t})}},{key:"getTaskCollaborators",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task;this.errorCode=A.ERROR_CODE_FETCH_TASK_COLLABORATOR;var i=this.getUrlForTaskCollaborators(o.id);this.get({id:r.id,successCallback:n,errorCallback:t,url:i})}},{key:"updateTaskCollaborator",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.taskCollaborator;this.errorCode=A.ERROR_CODE_UPDATE_TASK_COLLABORATOR;var i={data:tt()(o,"id")};this.put({id:r.id,url:this.getUrlForTaskCollaborator(o.id),data:ot({},i),successCallback:n,errorCallback:t})}},{key:"deleteTaskCollaborator",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.taskCollaborator;this.errorCode=A.ERROR_CODE_DELETE_TASK_COLLABORATOR,this.delete({id:r.id,url:this.getUrlForTaskCollaborator(o.id),successCallback:n,errorCallback:t})}}])&&st(r.prototype,n),o&&st(r,o),t}(qe);function pt(e){return(pt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){yt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function yt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vt(e,t){return!t||"object"!==pt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gt(e){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _t(e,t){return(_t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Et=function(e){function t(){return bt(this,t),vt(this,gt(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_t(e,t)}(t,e),r=t,(n=[{key:"getUrlForTaskLinkCreate",value:function(){return"".concat(this.getBaseApiUrl(),"/undoc/task_links")}},{key:"createTaskLink",value:function(e){var t=e.errorCallback,r=e.file,n=e.successCallback,o=e.task;this.errorCode=A.ERROR_CODE_CREATE_TASK_LINK;var i={data:{target:{id:r.id,type:"file"},task:{id:o.id,type:"task"}}};this.post({id:r.id,url:this.getUrlForTaskLinkCreate(),data:dt({},i),successCallback:n,errorCallback:t})}}])&&mt(r.prototype,n),o&&mt(r,o),t}(qe);function Ot(e){return(Ot="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Pt(e,t){return!t||"object"!==Ot(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wt(e){return(wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var At=function(e){function t(){return kt(this,t),Pt(this,wt(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(e){if(!e)throw new Error("Missing file id!");return"".concat(this.getBaseApiUrl(),"/file_access_stats/").concat(e)}},{key:"getFileAccessStats",value:function(e,t,r){this.errorCode=A.ERROR_CODE_FETCH_ACCESS_STATS,this.get({id:e,successCallback:t,errorCallback:r})}}])&&Ct(r.prototype,n),o&&Ct(r,o),t}(S.a),It=r("cr+IVGIN9M"),Tt=r.n(It),Rt=r("vVaM4hVnXJ");function Dt(e){return(Dt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jt(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function xt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ft(e,t){return!t||"object"!==Dt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ht(e,t){return(Ht=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mt=function(e){function t(){return xt(this,t),Ft(this,Nt(t).apply(this,arguments))}var r,n,o,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ht(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/users/me")}},{key:"getAvatarUrl",value:function(e){if(!e)throw new Error("Missing user id");return"".concat(this.getBaseApiUrl(),"/users/").concat(e,"/avatar")}},{key:"getAvatarUrlWithAccessToken",value:(i=regeneratorRuntime.mark((function e(t,r){var n,o,i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if(!(n=this.getCache()).has(t)){e.next=5;break}return e.abrupt("return",n.get(t));case 5:return e.next=7,Rt.a.getReadToken(Object(Z.getTypedFileId)(r),this.options.token);case 7:if("string"!==typeof(o=e.sent)){e.next=14;break}return i={access_token:o,pic_type:"large"},a=Tt.a.stringify(i),s="".concat(this.getAvatarUrl(t),"?").concat(a),n.set(t,s),e.abrupt("return",s);case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,n){var o=i.apply(e,t);function a(e){jt(o,r,n,a,s,"next",e)}function s(e){jt(o,r,n,a,s,"throw",e)}a(void 0)}))},function(e,t){return a.apply(this,arguments)})},{key:"getUser",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.errorCode=A.ERROR_CODE_FETCH_CURRENT_USER,this.get({id:e,successCallback:t,errorCallback:r,requestData:n})}}])&&Lt(r.prototype,n),o&&Lt(r,o),t}(S.a),Ut=r("mNz5hShaC3"),Bt=r.n(Ut);function Xt(e){return(Xt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Wt(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function Gt(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Wt(i,n,o,a,s,"next",e)}function s(e){Wt(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yt(e,t){return!t||"object"!==Xt(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zt(e){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qt(e,t){return(Qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=function(e){function t(){return Vt(this,t),Yt(this,zt(t).apply(this,arguments))}var r,n,o,i,a,s,c,u,l,f,p,h,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qt(e,t)}(t,e),r=t,(n=[{key:"getMetadataCacheKey",value:function(e){return"".concat(A.CACHE_PREFIX_METADATA).concat(e)}},{key:"getSkillsCacheKey",value:function(e){return"".concat(this.getMetadataCacheKey(e),"_skills")}},{key:"getClassificationCacheKey",value:function(e){return"".concat(this.getMetadataCacheKey(e),"_classification")}},{key:"getMetadataUrl",value:function(e,t,r){var n="".concat(this.getUrl(e),"/metadata");return t&&r?"".concat(n,"/").concat(t,"/").concat(r):n}},{key:"getMetadataTemplateUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/metadata_templates")}},{key:"getMetadataTemplateUrlForInstance",value:function(e){return"".concat(this.getMetadataTemplateUrl(),"?metadata_instance_id=").concat(e)}},{key:"getMetadataTemplateSchemaUrl",value:function(e){return"".concat(this.getMetadataTemplateUrl(),"/enterprise/").concat(e,"/schema")}},{key:"getMetadataTemplateUrlForScope",value:function(e){return"".concat(this.getMetadataTemplateUrl(),"/").concat(e)}},{key:"getCustomPropertiesTemplate",value:function(){return{id:Bt()("metadata_template_"),scope:A.METADATA_SCOPE_GLOBAL,templateKey:A.METADATA_TEMPLATE_PROPERTIES,hidden:!1}}},{key:"createEditor",value:function(e,t,r){var n={};return Object.keys(e).forEach((function(t){t.startsWith("$")||(n[t]=e[t])})),{template:t,instance:{id:e.$id,canEdit:e.$canEdit&&r,data:n}}}},{key:"getTemplates",value:(d=Gt(regeneratorRuntime.mark((function e(t,r,n){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.errorCode=A.ERROR_CODE_FETCH_METADATA_TEMPLATES,o={},i=n?this.getMetadataTemplateUrlForInstance(n):this.getMetadataTemplateUrlForScope(r),e.prev=3,e.next=6,this.xhr.get({url:i,id:Object(Z.getTypedFileId)(t),params:{limit:A.METADATA_TEMPLATE_FETCH_LIMIT}});case 6:o=e.sent,e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(3),a=e.t0.status,!Object(w.d)(a)){e.next=14;break}throw e.t0;case 14:return e.abrupt("return",Q()(o,"data.entries",[]));case 15:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"getSchemaByTemplateKey",value:function(e){var t=this.getMetadataTemplateSchemaUrl(e);return this.xhr.get({url:t})}},{key:"getInstances",value:(h=Gt(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.errorCode=A.ERROR_CODE_FETCH_METADATA,r={},e.prev=2,e.next=5,this.xhr.get({url:this.getMetadataUrl(t),id:Object(Z.getTypedFileId)(t)});case 5:r=e.sent,e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(2),n=e.t0.status,!Object(w.d)(n)){e.next=13;break}throw e.t0;case 13:return e.abrupt("return",Q()(r,"data.entries",[]));case 14:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e){return h.apply(this,arguments)})},{key:"getUserAddableTemplates",value:function(e,t,r,n){var o=[];return r&&(o=n?[e]:[e].concat(t)),o.filter((function(e){return!e.hidden&&e.templateKey!==A.METADATA_TEMPLATE_CLASSIFICATION}))}},{key:"extractClassification",value:function(e,t){var r=t.find((function(e){return e.$template===A.METADATA_TEMPLATE_CLASSIFICATION}));if(r){t.splice(t.indexOf(r),1);var n=this.getCache(),o=this.getClassificationCacheKey(e);n.set(o,r)}return t}},{key:"getTemplateForInstance",value:(p=Gt(regeneratorRuntime.mark((function e(t,r,n){var o,i,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.$id,i=r.$template,a=r.$scope,(s=n.find((function(e){return e.templateKey===i&&e.scope===a})))||!a.startsWith(A.METADATA_SCOPE_ENTERPRISE)){e.next=9;break}return e.next=7,this.getTemplates(t,a,o);case 7:c=e.sent,s=c[0];case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return p.apply(this,arguments)})},{key:"getEditors",value:(f=Gt(regeneratorRuntime.mark((function e(t,r,n,o,i,a){var s,c,u,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[n].concat(o,i),c=this.extractClassification(t,r),u=[],e.next=5,Promise.all(c.map(function(){var e=Gt(regeneratorRuntime.mark((function e(r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.getTemplateForInstance(t,r,s);case 2:(n=e.sent)&&u.push(l.createEditor(r,n,a));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,o,i){return f.apply(this,arguments)})},{key:"getMetadata",value:(l=Gt(regeneratorRuntime.mark((function e(t,r,n,o){var i,a,s,c,u,l,f,p,h,d,y,b,m,v,g=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=g.length>4&&void 0!==g[4]?g[4]:{},a=t.id,s=t.permissions,c=t.is_externally_owned,this.errorCode=A.ERROR_CODE_FETCH_METADATA,this.successCallback=r,this.errorCallback=n,a&&s){e.next=8;break}return this.errorHandler(Object(w.a)()),e.abrupt("return");case 8:if(u=this.getCache(),l=this.getMetadataCacheKey(a),i.forceFetch&&u.unset(l),!u.has(l)){e.next=15;break}if(this.successHandler(u.get(l)),i.refreshCache){e.next=15;break}return e.abrupt("return");case 15:return e.prev=15,f=this.getCustomPropertiesTemplate(),e.next=19,Promise.all([this.getInstances(a),this.getTemplates(a,A.METADATA_SCOPE_GLOBAL),o?this.getTemplates(a,A.METADATA_SCOPE_ENTERPRISE):Promise.resolve([])]);case 19:return p=e.sent,h=Kt(p,3),d=h[0],y=h[1],b=h[2],e.next=26,this.getEditors(a,d,f,b,y,!!s.can_upload);case 26:m=e.sent,v={editors:m,templates:this.getUserAddableTemplates(f,b,o,c)},u.set(l,v),this.isDestroyed()||this.successHandler(v),e.next=35;break;case 32:e.prev=32,e.t0=e.catch(15),this.errorHandler(e.t0);case 35:case"end":return e.stop()}}),e,this,[[15,32]])}))),function(e,t,r,n){return l.apply(this,arguments)})},{key:"getSkills",value:(u=Gt(regeneratorRuntime.mark((function e(t,r,n){var o,i,a,s,c,u,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=l.length>3&&void 0!==l[3]&&l[3],this.errorCode=A.ERROR_CODE_FETCH_SKILLS,i=t.id){e.next=6;break}return n(Object(w.a)(),this.errorCode),e.abrupt("return");case 6:if(a=this.getCache(),s=this.getSkillsCacheKey(i),this.successCallback=r,this.errorCallback=n,o&&a.unset(s),!a.has(s)){e.next=14;break}return this.successHandler(a.get(s)),e.abrupt("return");case 14:if(c={data:Q()(t,A.FIELD_METADATA_SKILLS)},e.prev=15,c.data){e.next=20;break}return e.next=19,this.xhr.get({url:this.getMetadataUrl(i,A.METADATA_SCOPE_GLOBAL,A.METADATA_TEMPLATE_SKILLS),id:Object(Z.getTypedFileId)(i)});case 19:c=e.sent;case 20:this.isDestroyed()||(u=c.data.cards||[],a.set(s,u),this.successHandler(u)),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(15),this.errorHandler(e.t0);case 26:case"end":return e.stop()}}),e,this,[[15,23]])}))),function(e,t,r){return u.apply(this,arguments)})},{key:"updateSkills",value:(c=Gt(regeneratorRuntime.mark((function e(t,r,n,o){var i,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.errorCode=A.ERROR_CODE_UPDATE_SKILLS,i=t.id,a=t.permissions,i&&a){e.next=5;break}return o(Object(w.a)(),this.errorCode),e.abrupt("return");case 5:if(a.can_upload){e.next=8;break}return o(Object(w.b)(),this.errorCode),e.abrupt("return");case 8:return this.successCallback=n,this.errorCallback=o,e.prev=10,e.next=13,this.xhr.put({url:this.getMetadataUrl(i,A.METADATA_SCOPE_GLOBAL,A.METADATA_TEMPLATE_SKILLS),headers:qt({},A.HEADER_CONTENT_TYPE,"application/json-patch+json"),id:Object(Z.getTypedFileId)(i),data:r});case 13:s=e.sent,this.isDestroyed()||(c=s.data.cards||[],this.merge(this.getCacheKey(i),A.FIELD_METADATA_SKILLS,s.data),this.getCache().set(this.getSkillsCacheKey(i),c),this.successHandler(c)),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(10),this.errorHandler(e.t0);case 20:case"end":return e.stop()}}),e,this,[[10,17]])}))),function(e,t,r,n){return c.apply(this,arguments)})},{key:"updateMetadata",value:(s=Gt(regeneratorRuntime.mark((function e(t,r,n,o,i){var a,s,c,u,l,f,p,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.errorCode=A.ERROR_CODE_UPDATE_METADATA,this.successCallback=o,this.errorCallback=i,a=t.id,s=t.permissions,a&&s){e.next=7;break}return this.errorHandler(Object(w.a)()),e.abrupt("return");case 7:if(c=!!s.can_upload){e.next=11;break}return this.errorHandler(Object(w.b)()),e.abrupt("return");case 11:return e.prev=11,e.next=14,this.xhr.put({url:this.getMetadataUrl(a,r.scope,r.templateKey),headers:qt({},A.HEADER_CONTENT_TYPE,"application/json-patch+json"),id:Object(Z.getTypedFileId)(a),data:n});case 14:u=e.sent,this.isDestroyed()||(l=this.getCache(),f=this.getMetadataCacheKey(a),p=l.get(f),h=this.createEditor(u.data,r,c),p&&p.editors&&p.editors.splice(p.editors.findIndex((function(e){return e.instance.id===h.instance.id})),1,h),this.successHandler(h)),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(11),this.errorHandler(e.t0);case 21:case"end":return e.stop()}}),e,this,[[11,18]])}))),function(e,t,r,n,o){return s.apply(this,arguments)})},{key:"createMetadata",value:(a=Gt(regeneratorRuntime.mark((function e(t,r,n,o){var i,a,s,c,u,l,f,p,h,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.errorCode=A.ERROR_CODE_CREATE_METADATA,t&&r){e.next=4;break}return o(Object(w.a)(),this.errorCode),e.abrupt("return");case 4:if(i=t.id,a=t.permissions,s=t.is_externally_owned,i&&a){e.next=8;break}return o(Object(w.a)(),this.errorCode),e.abrupt("return");case 8:if(c=!!a.can_upload,u=r.templateKey===A.METADATA_TEMPLATE_PROPERTIES&&r.scope===A.METADATA_SCOPE_GLOBAL,c&&(!s||u)){e.next=13;break}return o(Object(w.b)(),this.errorCode),e.abrupt("return");case 13:return this.successCallback=n,this.errorCallback=o,e.prev=15,e.next=18,this.xhr.post({url:this.getMetadataUrl(i,r.scope,r.templateKey),id:Object(Z.getTypedFileId)(i),data:{}});case 18:l=e.sent,this.isDestroyed()||(f=this.getCache(),p=this.getMetadataCacheKey(i),h=f.get(p),d=this.createEditor(l.data,r,c),h.editors.push(d),this.successHandler(d)),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(15),this.errorHandler(e.t0);case 25:case"end":return e.stop()}}),e,this,[[15,22]])}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"deleteMetadata",value:(i=Gt(regeneratorRuntime.mark((function e(t,r,n,o){var i,a,s,c,u,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.errorCode=A.ERROR_CODE_DELETE_METADATA,t&&r){e.next=4;break}return o(Object(w.a)(),this.errorCode),e.abrupt("return");case 4:if(i=r.scope,a=r.templateKey,s=t.id,c=t.permissions,s&&c){e.next=9;break}return o(Object(w.a)(),this.errorCode),e.abrupt("return");case 9:if(c.can_upload){e.next=12;break}return o(Object(w.b)(),this.errorCode),e.abrupt("return");case 12:return this.successCallback=n,this.errorCallback=o,e.prev=14,e.next=17,this.xhr.delete({url:this.getMetadataUrl(s,i,a),id:Object(Z.getTypedFileId)(s)});case 17:this.isDestroyed()||(u=this.getCache(),l=this.getMetadataCacheKey(s),(f=u.get(l)).editors.splice(f.editors.findIndex((function(e){return e.template.scope===i&&e.template.templateKey===a})),1),this.successHandler()),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(14),this.errorHandler(e.t0);case 23:case"end":return e.stop()}}),e,this,[[14,20]])}))),function(e,t,r,n){return i.apply(this,arguments)})}])&&Jt(r.prototype,n),o&&Jt(r,o),t}(O.a);function $t(e){return($t="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){rr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function rr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nr(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function or(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){nr(i,n,o,a,s,"next",e)}function s(e){nr(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sr(e,t){return!t||"object"!==$t(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cr(e){return(cr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ur(e,t){return(ur=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lr=function(e){function t(){return ir(this,t),sr(this,cr(t).apply(this,arguments))}var r,n,o,i,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ur(e,t)}(t,e),r=t,(n=[{key:"hasMoreItems",value:function(e){return null!==e&&""!==e}},{key:"markerGetRequest",value:(a=or(regeneratorRuntime.mark((function e(t,r,n,o){var i,a,s,c,u,l,f,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=p.length>4&&void 0!==p[4]?p[4]:{},!this.isDestroyed()){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,a=this.getUrl(t),s=tr({},i,{marker:r,limit:n}),e.next=8,this.xhr.get({url:a,id:Object(Z.getTypedFileId)(t),params:s});case 8:if(c=e.sent,u=c.data,l=this.data?this.data.entries:[],this.data=tr({},u,{entries:l.concat(u.entries)}),f=u.next_marker,!o||!this.hasMoreItems(f)){e.next=16;break}return this.markerGetRequest(t,f,n,o,i),e.abrupt("return");case 16:this.successHandler(this.data),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),this.errorHandler(e.t0);case 22:case"end":return e.stop()}}),e,this,[[3,19]])}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"markerGet",value:(i=or(regeneratorRuntime.mark((function e(t){var r,n,o,i,a,s,c,u,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,n=t.successCallback,o=t.errorCallback,i=t.marker,a=void 0===i?"":i,s=t.limit,c=void 0===s?1e3:s,u=t.requestData,l=t.shouldFetchAll,f=void 0===l||l,this.successCallback=n,this.errorCallback=o,e.abrupt("return",this.markerGetRequest(r,a,c,f,u));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}])&&ar(r.prototype,n),o&&ar(r,o),t}(S.a);function fr(e){return(fr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(r),!0).forEach((function(t){_r(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function dr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function br(e,t){return!t||"object"!==fr(t)&&"function"!==typeof t?vr(e):t}function mr(e){return(mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gr(e,t){return(gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Er=function(e){function t(){var e,r;dr(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return _r(vr(r=br(this,(e=mr(t)).call.apply(e,[this].concat(o)))),"successHandler",(function(e){if(!r.isDestroyed()&&"function"===typeof r.successCallback){var t=e.entries.map((function(e){var t;return"group"===e.type?t=e:(t=e).email=t.login,{id:e.id,name:e.name,item:t}}));r.successCallback(hr({},e,{entries:t}))}})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gr(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(e){if(!e)throw new Error("Missing file id!");return"".concat(this.getBaseApiUrl(),"/files/").concat(e,"/collaborators")}},{key:"getFileCollaborators",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:A.DEFAULT_MAX_COLLABORATORS;this.markerGet({id:e,limit:o,successCallback:t,errorCallback:r,requestData:n})}}])&&yr(r.prototype,n),o&&yr(r,o),t}(lr),Or=r("TYy9hCwbQY"),kr=r.n(Or),Cr=r("rXqiGNCH6O"),Pr=r("zJHzwnUt45");function wr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.reduce((function(e,t){return t?e.concat(t.entries):e}),[]).sort((function(e,t){return Date.parse(e.created_at)-Date.parse(t.created_at)}));return n}var Sr=r("QkVNESsdth"),Ar=r.n(Sr);function Ir(e){return(Ir="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dr(e,t){return!t||"object"!==Ir(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jr(e){return(jr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xr(e,t){return(xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lr=function(e){function t(){return Tr(this,t),Dr(this,jr(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xr(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/internal_annotations")}},{key:"getUrlForId",value:function(e){return"".concat(this.getUrl(),"/").concat(e)}},{key:"createAnnotation",value:function(e,t,r,n,o){var i={description:{type:"reply"},file_version:{id:t,type:"file_version"},status:"open",type:"annotation"};return this.post({id:e,data:{data:Ar()(i,r)},errorCallback:o,successCallback:n,url:this.getUrl()})}},{key:"deleteAnnotation",value:function(e,t,r,n){return this.delete({id:e,errorCallback:n,successCallback:r,url:this.getUrlForId(t)})}},{key:"getAnnotation",value:function(e,t,r,n){return this.get({id:e,errorCallback:n,successCallback:r,url:this.getUrlForId(t)})}},{key:"getAnnotations",value:function(e,t,r,n,o,i){return this.markerGet({id:e,errorCallback:n,limit:o,requestData:{file_id:e,file_version_id:t},shouldFetchAll:i,successCallback:r})}}])&&Rr(r.prototype,n),o&&Rr(r,o),t}(lr);function Fr(e){return(Fr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mr(e,t){return!t||"object"!==Fr(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ur(e){return(Ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Br(e,t){return(Br=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xr=function(e){function t(){return Nr(this,t),Mr(this,Ur(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Br(e,t)}(t,e),r=t,(n=[{key:"getUrlForGroupCount",value:function(e){return"".concat(this.getBaseApiUrl(),"/groups/").concat(e,"/memberships")}},{key:"getGroupCount",value:function(e){var t=this,r=e.errorCallback,n=void 0===r?a.a:r,o=e.successCallback,i=void 0===o?a.a:o,s=e.group,c=e.file;return new Promise((function(e,r){return t.get({id:c.id,url:t.getUrlForGroupCount(s.id),successCallback:function(){i.apply(void 0,arguments),e.apply(void 0,arguments)},errorCallback:function(){n.apply(void 0,arguments),r()},requestData:{params:{limit:1}}})}))}}])&&Hr(r.prototype,n),o&&Hr(r,o),t}(S.a);function qr(e){return(qr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gr(e,t){return!t||"object"!==qr(t)&&"function"!==typeof t?Jr(e):t}function Vr(e){return(Vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Yr(e,t){return(Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Qr=function(e){function t(){var e,r;Kr(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return zr(Jr(r=Gr(this,(e=Vr(t)).call.apply(e,[this].concat(o)))),"permissions",{}),zr(Jr(r),"mapAppActivityItem",(function(e){var t=e.activity_template,n=e.app,o=e.created_by,i=e.id,a=e.occurred_at,s=e.rendered_text,c=e.type;return{activity_template:t,app:n,created_at:a,created_by:o,id:i,permissions:{can_delete:r.permissions.can_delete},rendered_text:s,type:c}})),zr(Jr(r),"successHandler",(function(e){var t=e.entries,n=void 0===t?[]:t;if(!r.isDestroyed()&&"function"===typeof r.successCallback){var o=n.map(r.mapAppActivityItem);r.successCallback({entries:o,total_count:o.length})}})),zr(Jr(r),"errorHandler",(function(e){if(!r.isDestroyed()||"function"===typeof r.errorCallback){var t=e.response;t.status===A.HTTP_STATUS_CODE_NOT_FOUND?r.successHandler({entries:[],total_count:0}):r.errorCallback(e,t.status)}})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yr(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/app_activities")}},{key:"getDeleteUrl",value:function(e){if(!e)throw new Error("Missing file id!");return"".concat(this.getUrl(),"/").concat(e)}},{key:"getAppActivity",value:function(e,t,r,n){var o={item_id:e,item_type:"file",fields:P.a.toString()};this.permissions=t,this.markerGet({id:e,successCallback:r,errorCallback:n,requestData:o})}},{key:"deleteAppActivity",value:function(e){var t=e.id,r=e.appActivityId,n=e.successCallback,o=e.errorCallback;this.errorCode=A.ERROR_CODE_DELETE_APP_ACTIVITY,this.delete({id:t,url:this.getDeleteUrl(r),successCallback:n,errorCallback:o})}}])&&Wr(r.prototype,n),o&&Wr(r,o),t}(lr);function Zr(e){return(Zr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $r(e){return function(e){if(Array.isArray(e))return e}(e)||tn(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function en(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||tn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function tn(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function rn(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function nn(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){rn(i,n,o,a,s,"next",e)}function s(e){rn(i,n,o,a,s,"throw",e)}a(void 0)}))}}function on(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function an(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?on(Object(r),!0).forEach((function(t){pn(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):on(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function un(e,t,r){return(un="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ln(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var hn=A.TASK_NEW_NOT_STARTED,dn=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Zr(t)&&"function"!==typeof t?cn(e):t}(this,ln(t).call(this,e)),pn(cn(r),"updateTaskCollaborator",(function(e,t,n,o,i,a){if(!e.id)throw Object(w.a)();r.file=e,r.errorCallback=a,r.updateFeedItem({isPending:!0},t);var s=new ft(r.options);r.taskCollaboratorsAPI.push(s);var c={id:n,status:o},u=function(e,n){var i;switch(o){case A.TASK_NEW_APPROVED:i=Pr.a.taskApproveErrorMessage;break;case A.TASK_NEW_COMPLETED:i=Pr.a.taskCompleteErrorMessage;break;case A.TASK_NEW_REJECTED:i=Pr.a.taskRejectErrorMessage;break;default:i=Pr.a.taskCompleteErrorMessage}r.updateFeedItem(r.createFeedError(i,Pr.a.taskActionErrorTitle),t),r.feedErrorCallback(!0,e,n)};s.updateTaskCollaborator({file:e,taskCollaborator:c,successCallback:function(n){r.updateTaskCollaboratorSuccessCallback(t,e,n,i,u)},errorCallback:u})})),pn(cn(r),"updateTaskCollaboratorSuccessCallback",(function(e,t,n,o,i){r.tasksNewAPI=new $e(r.options),r.tasksNewAPI.getTask({id:e,file:t,successCallback:function(t){r.updateFeedItem(an({},t,{isPending:!1}),e),o(n)},errorCallback:i})})),pn(cn(r),"updateTaskNew",function(){var e=nn(regeneratorRuntime.mark((function e(t,n){var o,i,s,c,u,l,f,p,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=h.length>2&&void 0!==h[2]?h[2]:a.a,i=h.length>3&&void 0!==h[3]?h[3]:a.a,t.id){e.next=4;break}throw Object(w.a)();case 4:return s=!0,r.file=t,r.errorCallback=i,r.tasksNewAPI=new $e(r.options),r.updateFeedItem({isPending:!0},n.id),e.prev=9,u=n.addedAssignees.filter((function(e){return e.item&&"group"===e.item.type})).map((function(e){return e.id})).map((function(e){return new Xr(r.options).getGroupCount({file:t,group:{id:e}})})),e.next=13,Promise.all(u);case 13:if(l=e.sent,f=l.some((function(e){return e.total_count>A.TASK_MAX_GROUP_ASSIGNEES})),p={code:A.ERROR_CODE_GROUP_EXCEEDS_LIMIT,type:"warning"},!f){e.next=19;break}return r.feedErrorCallback(!1,p,A.ERROR_CODE_GROUP_EXCEEDS_LIMIT),e.abrupt("return");case 19:return e.next=21,Promise.all(n.addedAssignees.map((function(e){return e.item&&"group"===e.item.type?r.createTaskCollaboratorsforGroup(t,n,e):r.createTaskCollaborator(t,n,e)})));case 21:return e.next=23,new Promise((function(e,o){r.tasksNewAPI.updateTask({file:t,task:n,successCallback:e,errorCallback:o})}));case 23:return e.next=25,Promise.all(n.removedAssignees.map((function(e){return r.deleteTaskCollaborator(t,n,e)}))).catch((function(e){s=!1,c=e}));case 25:return e.next=27,new Promise((function(e,o){r.tasksNewAPI.getTask({file:t,id:n.id,successCallback:function(t){r.updateFeedItem(an({},t,{isPending:!1}),n.id),s||r.feedErrorCallback(!1,c,A.ERROR_CODE_UPDATE_TASK),e()},errorCallback:function(e){r.updateFeedItem({isPending:!1},n.id),r.feedErrorCallback(!1,e,A.ERROR_CODE_UPDATE_TASK),o()}})}));case 27:!r.isDestroyed()&&s&&o(),e.next=34;break;case 30:e.prev=30,e.t0=e.catch(9),r.updateFeedItem({isPending:!1},n.id),r.feedErrorCallback(!1,e.t0,A.ERROR_CODE_UPDATE_TASK);case 34:case"end":return e.stop()}}),e,null,[[9,30]])})));return function(t,r){return e.apply(this,arguments)}}()),pn(cn(r),"deleteComment",(function(e,t,n,o,i){if(r.commentsAPI=new xe(r.options),!e.id)throw Object(w.a)();r.file=e,r.errorCallback=i,r.updateFeedItem({isPending:!0},t),r.commentsAPI.deleteComment({file:e,commentId:t,permissions:n,successCallback:r.deleteFeedItem.bind(cn(r),t,o),errorCallback:function(e,n){r.deleteCommentErrorCallback(e,n,t)}})})),pn(cn(r),"deleteCommentErrorCallback",(function(e,t,n){r.updateFeedItem(r.createFeedError(Pr.a.commentDeleteErrorMessage),n),r.feedErrorCallback(!0,e,t)})),pn(cn(r),"createTaskNew",(function(e,t,n,o,i,a,s,c,u){if(!e.id)throw Object(w.a)();r.file=e,r.errorCallback=u;var l,f=Bt()("task_");a&&(l=new Date(a).toISOString());var p={created_by:{type:"task_collaborator",target:t,id:Bt()(),role:"CREATOR",status:hn},completion_rule:s,created_at:(new Date).toISOString(),due_at:l,id:f,description:n,type:"task",assigned_to:{entries:o.map((function(e){return{id:Bt()(),target:an({},e,{avatar_url:"",type:"user"}),status:hn,permissions:{can_delete:!1,can_update:!1},role:"ASSIGNEE",type:"task_collaborator"}})),limit:10,next_marker:null},permissions:{can_update:!1,can_delete:!1,can_create_task_collaborator:!1,can_create_task_link:!1},task_links:{entries:[{id:Bt()(),type:"task_link",target:an({type:"file"},e),permissions:{can_delete:!1,can_update:!1}}],limit:1,next_marker:null},task_type:i,status:A.TASK_NEW_NOT_STARTED},h={description:n,due_at:l,task_type:i,completion_rule:s},d=o.filter((function(e){return"group"===(e.item&&e.item.type)})).map((function(e){return e.id})).map((function(t){return new Xr(r.options).getGroupCount({file:e,group:{id:t}})}));Promise.all(d).then((function(n){var i=n.some((function(e){return e.total_count>A.TASK_MAX_GROUP_ASSIGNEES})),a={code:A.ERROR_CODE_GROUP_EXCEEDS_LIMIT,type:"warning"};i?r.feedErrorCallback(!1,a,A.ERROR_CODE_GROUP_EXCEEDS_LIMIT):(r.tasksNewAPI=new $e(r.options),r.tasksNewAPI.createTask({file:e,task:h,successCallback:function(n){r.addPendingItem(r.file.id,t,p),r.createTaskNewSuccessCallback(e,f,n,o,c,u)},errorCallback:function(e,t){r.feedErrorCallback(!1,e,t)}}))})).catch((function(e){r.feedErrorCallback(!1,e,A.ERROR_CODE_CREATE_TASK)}))})),pn(cn(r),"deleteTaskNew",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.a,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.a;if(!e.id)throw Object(w.a)();r.file=e,r.errorCallback=o,r.tasksNewAPI=new $e(r.options),r.updateFeedItem({isPending:!0},t.id),r.tasksNewAPI.deleteTask({file:e,task:t,successCallback:r.deleteFeedItem.bind(cn(r),t.id,n),errorCallback:function(e,n){r.updateFeedItem(r.createFeedError(Pr.a.taskDeleteErrorMessage),t.id),r.feedErrorCallback(!0,e,n)}})})),pn(cn(r),"deleteFeedItem",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.a,n=r.getCachedItems(r.file.id);if(n){var o=n.items.filter((function(t){return t.id!==e}));r.setCachedItems(r.file.id,o),r.isDestroyed()||t(e)}})),pn(cn(r),"feedErrorCallback",(function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;e&&(r.hasError=!0),!r.isDestroyed()&&r.errorCallback&&r.errorCallback(t,n,pn({error:t},A.IS_ERROR_DISPLAYED,e)),console.error(t)})),pn(cn(r),"addPendingItem",(function(e,t,n){if(!t)throw Object(w.c)();var o=(new Date).toISOString(),i=an({created_at:o,created_by:t,modified_at:o,isPending:!0},n),a=r.getCachedItems(r.file.id),s=a?a.items:[],c=[].concat(en(s),[i]);return r.setCachedItems(e,c),i})),pn(cn(r),"createCommentSuccessCallback",(function(e,t,n){var o=e.message,i=void 0===o?"":o,a=e.tagged_message,s=void 0===a?"":a;e.tagged_message=s||i,r.updateFeedItem(an({},e,{isPending:!1}),t),r.isDestroyed()||n(e)})),pn(cn(r),"createCommentErrorCallback",(function(e,t,n){var o=e.status===A.HTTP_STATUS_CODE_CONFLICT?Pr.a.commentCreateConflictMessage:Pr.a.commentCreateErrorMessage;r.updateFeedItem(r.createFeedError(o),n),r.feedErrorCallback(!1,e,t)})),pn(cn(r),"updateFeedItem",(function(e,t){if(!r.file.id)throw Object(w.a)();var n=r.getCachedItems(r.file.id);if(n){var o=n.items.map((function(r){return r.id===t?an({},r,{},e):r}));return r.setCachedItems(r.file.id,o),o}return null})),pn(cn(r),"createComment",(function(e,t,n,o,i,a){var s=Bt()("comment_"),c={id:s,tagged_message:n,type:"comment"};if(!e.id)throw Object(w.a)();r.file=e,r.errorCallback=a,r.addPendingItem(r.file.id,t,c);var u={};o?u.taggedMessage=n:u.message=n,r.commentsAPI=new xe(r.options),r.commentsAPI.createComment(an({file:e},u,{successCallback:function(e){r.createCommentSuccessCallback(e,s,i)},errorCallback:function(e,t){r.createCommentErrorCallback(e,t,s)}}))})),pn(cn(r),"updateComment",(function(e,t,n,o,i,a,s){var c={tagged_message:n};if(!e.id)throw Object(w.a)();r.file=e,r.errorCallback=s,r.updateFeedItem(an({},c,{isPending:!0}),t);var u={};o?u.tagged_message=n:u.message=n,r.commentsAPI=new xe(r.options),r.commentsAPI.updateComment(an({file:e,commentId:t,permissions:i},u,{successCallback:function(e){r.updateFeedItem(an({},u,{isPending:!1}),t),r.isDestroyed()||a(e)},errorCallback:function(e,t){r.feedErrorCallback(!0,e,t)}}))})),pn(cn(r),"deleteAppActivity",(function(e,t,n,o){var i=e.id;if(!i)throw Object(w.a)();r.appActivityAPI=new Qr(r.options),r.file=e,r.errorCallback=o,r.updateFeedItem({isPending:!0},t),r.appActivityAPI.deleteAppActivity({id:i,appActivityId:t,successCallback:r.deleteFeedItem.bind(cn(r),t,n),errorCallback:function(e,n){r.deleteAppActivityErrorCallback(e,n,t)}})})),pn(cn(r),"deleteAppActivityErrorCallback",(function(e,t,n){r.updateFeedItem(r.createFeedError(Pr.a.appActivityDeleteErrorMessage),n),r.feedErrorCallback(!0,e,t)})),r.taskCollaboratorsAPI=[],r.taskLinksAPI=[],r}var r,n,o,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,e),r=t,(n=[{key:"addAnnotation",value:function(e,t,r,n,o){if(!e.id)throw Object(w.a)();if(this.file=e,o){var i=an({},r,{created_by:t,id:n,type:"annotation"});this.addPendingItem(this.file.id,t,i)}else this.updateFeedItem(an({},r,{isPending:!1}),n)}},{key:"getCacheKey",value:function(e){return"".concat(A.TYPED_ID_FEED_PREFIX).concat(e)}},{key:"getCachedItems",value:function(e){var t=this.getCache(),r=this.getCacheKey(e);return t.get(r)}},{key:"setCachedItems",value:function(e,t){var r=this.getCache(),n=this.getCacheKey(e);r.set(n,{hasError:!!this.hasError,items:t})}},{key:"feedItems",value:function(e){function t(t,r,n,o,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,r,n,o){var i=this,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=a.shouldShowAnnotations,c=void 0!==s&&s,u=a.shouldShowAppActivity,l=void 0!==u&&u,f=e.id,p=e.permissions,h=void 0===p?{}:p,d=this.getCachedItems(f);if(d){var y=d.hasError,b=d.items;if(y?n(b):r(b),!t)return}this.file=e,this.hasError=!1,this.errorCallback=o;var m=c?this.fetchAnnotations():Promise.resolve(),v=this.fetchVersions(),g=this.fetchCurrentVersion(),_=this.fetchComments(h),E=this.fetchTasksNew(),O=l?this.fetchAppActivity(h):Promise.resolve();Promise.all([v,g,_,E,O,m]).then((function(e){var t=$r(e),o=t[0],a=t[1],s=t.slice(2),c=i.versionsAPI.addCurrentVersion(a,o,i.file),u=wr.apply(void 0,[c].concat(en(s)));i.isDestroyed()||(i.setCachedItems(f,u),i.hasError?n(u):r(u))}))}))},{key:"fetchAnnotations",value:function(){var e=this;return this.annotationsAPI=new Lr(this.options),new Promise((function(t){e.annotationsAPI.getAnnotations(e.file.id,void 0,t,e.fetchFeedItemErrorCallback.bind(e,t))}))}},{key:"fetchComments",value:function(e){var t=this;return this.commentsAPI=new xe(this.options),new Promise((function(r){t.commentsAPI.getComments(t.file.id,e,r,t.fetchFeedItemErrorCallback.bind(t,r))}))}},{key:"fetchVersions",value:function(){var e=this;return this.versionsAPI=new ke(this.options),new Promise((function(t){e.versionsAPI.getVersions(e.file.id,t,e.fetchFeedItemErrorCallback.bind(e,t))}))}},{key:"fetchCurrentVersion",value:function(){var e=this;return this.versionsAPI=new ke(this.options),new Promise((function(t){var r=e.file.file_version,n=void 0===r?{}:r;e.versionsAPI.getVersion(e.file.id,n.id,t,e.fetchFeedItemErrorCallback.bind(e,t))}))}},{key:"fetchTasksNew",value:function(){var e=this;return this.tasksNewAPI=new $e(this.options),new Promise((function(t){e.tasksNewAPI.getTasksForFile({file:{id:e.file.id},successCallback:t,errorCallback:function(r,n){return e.fetchFeedItemErrorCallback(t,r,n)}})}))}},{key:"fetchFeedItemErrorCallback",value:function(e,t,r){var n=t.status,o=Object(w.d)(n);this.feedErrorCallback(o,t,r),e()}},{key:"createTaskNewSuccessCallback",value:(i=nn(regeneratorRuntime.mark((function e(t,r,n,o,i,a){var s,c,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw Object(w.a)();case 2:return this.errorCallback=a,e.prev=3,e.next=6,this.createTaskLink(t,n);case 6:return s=e.sent,e.t0=kr.a,e.next=10,Promise.all(o.map((function(e){return e.item&&"group"===e.item.type?u.createTaskCollaboratorsforGroup(t,n,e):u.createTaskCollaborator(t,n,e)})));case 10:e.t1=e.sent,c=(0,e.t0)(e.t1),this.updateFeedItem(an({},n,{task_links:{entries:[s],next_marker:null,limit:1},assigned_to:{entries:c,next_marker:null,limit:c.length},isPending:!1}),r),i(n),e.next=19;break;case 16:e.prev=16,e.t2=e.catch(3),this.feedErrorCallback(!1,e.t2,A.ERROR_CODE_CREATE_TASK);case 19:case"end":return e.stop()}}),e,this,[[3,16]])}))),function(e,t,r,n,o,a){return i.apply(this,arguments)})},{key:"createTaskCollaboratorsforGroup",value:function(e,t,r){var n=this;if(!e.id)throw Object(w.a)();return this.file=e,new Promise((function(o,i){var a=new ft(n.options);n.taskCollaboratorsAPI.push(a),a.createTaskCollaboratorsforGroup({file:e,task:t,group:r,successCallback:o,errorCallback:function(e){i(e)}})}))}},{key:"createTaskCollaborator",value:function(e,t,r){var n=this;if(!e.id)throw Object(w.a)();return this.file=e,new Promise((function(o,i){var a=new ft(n.options);n.taskCollaboratorsAPI.push(a),a.createTaskCollaborator({file:e,task:t,user:r,successCallback:o,errorCallback:function(e){i(e)}})}))}},{key:"deleteTaskCollaborator",value:function(e,t,r){var n=this;if(!e.id)throw Object(w.a)();return this.file.id=e.id,new Promise((function(o,i){var a=new ft(n.options);n.taskCollaboratorsAPI.push(a),a.deleteTaskCollaborator({file:e,task:t,taskCollaborator:{id:r.id},successCallback:o,errorCallback:function(e){i(e)}})}))}},{key:"createTaskLink",value:function(e,t){var r=this;if(!e.id)throw Object(w.a)();return this.file=e,new Promise((function(n,o){var i=new Et(r.options);r.taskLinksAPI.push(i),i.createTaskLink({file:e,task:t,successCallback:n,errorCallback:o})}))}},{key:"createFeedError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cr.a.errorOccured;return{error:{message:e,title:t}}}},{key:"destroyTaskCollaborators",value:function(){Array.isArray(this.taskCollaboratorsAPI)&&(this.taskCollaboratorsAPI.forEach((function(e){return e.destroy()})),this.taskCollaboratorsAPI=[])}},{key:"destroyTaskLinks",value:function(){Array.isArray(this.taskLinksAPI)&&(this.taskLinksAPI.forEach((function(e){return e.destroy()})),this.taskLinksAPI=[])}},{key:"fetchAppActivity",value:function(e){var t=this;return this.appActivityAPI=new Qr(this.options),new Promise((function(r){t.appActivityAPI.getAppActivity(t.file.id,e,r,t.fetchFeedItemErrorCallback.bind(t,r))}))}},{key:"destroy",value:function(){un(ln(t.prototype),"destroy",this).call(this),this.annotationsAPI&&(this.annotationsAPI.destroy(),delete this.annotationsAPI),this.commentsAPI&&(this.commentsAPI.destroy(),delete this.commentsAPI),this.versionsAPI&&(this.versionsAPI.destroy(),delete this.versionsAPI),this.appActivityAPI&&(this.appActivityAPI.destroy(),delete this.appActivityAPI),this.tasksNewAPI&&(this.tasksNewAPI.destroy(),delete this.tasksNewAPI),this.destroyTaskCollaborators(),this.destroyTaskLinks()}}])&&sn(r.prototype,n),o&&sn(r,o),t}(S.a);function yn(e){return(yn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vn(e,t){return!t||"object"!==yn(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gn(e){return(gn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _n(e,t){return(_n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var En=function(e){function t(){return bn(this,t),vn(this,gn(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_n(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(e){if(!e)throw new Error("Missing app integration id!");return"".concat(this.getBaseApiUrl(),"/app_integrations/").concat(e)}},{key:"execute",value:function(e,t,r,n){if(!e)throw new Error("Missing integration id!");if(!t)throw new Error("Missing file id!");this.errorCode=A.ERROR_CODE_EXECUTE_INTEGRATION;var o="".concat(this.getUrl(e),"/execute"),i={data:{item:{id:t,type:A.TYPE_FILE}}};this.post({id:t,url:o,data:i,successCallback:r,errorCallback:n})}}])&&mn(r.prototype,n),o&&mn(r,o),t}(S.a);function On(e){return(On="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kn(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Cn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wn(e,t){return!t||"object"!==On(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sn(e){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function An(e,t){return(An=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var In=function(e){function t(){return Cn(this,t),wn(this,Sn(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&An(e,t)}(t,e),r=t,(n=[{key:"getUrl",value:function(e){if(!e)throw new Error("Missing file id!");return"".concat(this.getBaseApiUrl(),"/files/").concat(e,"/open_with_integrations")}},{key:"getOpenWithIntegrations",value:function(e,t,r){var n=this;this.errorCode=A.ERROR_CODE_FETCH_INTEGRATIONS,this.get({id:e,successCallback:function(e){var r=n.formatOpenWithData(e),o=n.consolidateBoxEditIntegrations(r);t(o)},errorCallback:r})}},{key:"consolidateBoxEditIntegrations",value:function(e){var t=kn(e);return e.some((function(e){return e.appIntegrationId===A.BOX_EDIT_INTEGRATION_ID}))&&(t=e.filter((function(e){return e.appIntegrationId!==A.BOX_EDIT_SFC_INTEGRATION_ID}))),t}},{key:"formatOpenWithData",value:function(e){var t=e.items,r=e.default_app_integration;return t.map((function(e){var t=e.app_integration,n=e.disabled_reasons,o=e.display_name,i=e.display_description,a=e.display_order,s=e.is_disabled,c=e.should_show_consent_popup,u=t.id,l=t.type;return{appIntegrationId:u,displayDescription:i,disabledReasons:n||[],displayOrder:a,isDefault:!!r&&u===r.id,isDisabled:s,displayName:o,requiresConsent:c,type:l}})).sort((function(e,t){return e.displayOrder-t.displayOrder}))}}])&&Pn(r.prototype,n),o&&Pn(r,o),t}(S.a);function Tn(e){return(Tn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jn(e,t){return!t||"object"!==Tn(t)&&"function"!==typeof t?Ln(e):t}function xn(e){return(xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ln(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fn(e,t){return(Fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nn(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Hn=function(e){function t(){var e,r;Rn(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return Nn(Ln(r=jn(this,(e=xn(t)).call.apply(e,[this].concat(o)))),"queryMetadataSuccessHandler",(function(e){var t=e.data;r.getCache().set(r.key,t),r.finish()})),r}var r,n,o;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fn(e,t)}(t,e),r=t,(n=[{key:"getCacheKey",value:function(e){return"".concat(A.CACHE_PREFIX_METADATA_QUERY).concat(e)}},{key:"getUrl",value:function(){return"".concat(this.getBaseApiUrl(),"/metadata_queries/execute_read")}},{key:"isLoaded",value:function(){return this.getCache().has(this.key)}},{key:"finish",value:function(){if(!this.isDestroyed()){var e=this.getCache().get(this.key);this.successCallback(e)}}},{key:"queryMetadataRequest",value:function(e){this.isDestroyed()||(this.errorCode=A.ERROR_CODE_METADATA_QUERY,this.xhr.post({url:this.getUrl(),data:e}).then(this.queryMetadataSuccessHandler).catch(this.errorHandler))}},{key:"queryMetadata",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!this.isDestroyed()){var o=n.context,i=void 0===o?{}:o;this.key=this.getCacheKey(i.id),this.successCallback=t,this.errorCallback=r,n.forceFetch&&this.getCache().unset(this.key),this.isLoaded()?this.finish():this.queryMetadataRequest(e)}}}])&&Dn(r.prototype,n),o&&Dn(r,o),t}(S.a);function Mn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Un="Chrome",Bn="Edge",Xn="Firefox",qn="Mac",Kn="Safari",Wn="Explorer",Gn=[{key:"userAgent",subString:Bn,identity:Bn},{key:"userAgent",subString:Un,identity:Un},{key:"userAgent",subString:"criOS",identity:Un,versionSearch:"criOS"},{key:"vendor",subString:"Apple",identity:Kn,versionSearch:"Version"},{key:"userAgent",subString:Xn,identity:Xn},{key:"userAgent",subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{key:"userAgent",subString:"Trident",identity:"Explorer",versionSearch:"rv"},{key:"userAgent",subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}],Vn=[{key:"platform",subString:"Win",identity:"Windows"},{key:"userAgent",subString:"iPod",identity:"iOS",device:"iPod"},{key:"userAgent",subString:"iPhone",identity:"iOS",device:"iPhone"},{key:"userAgent",subString:"iPad",identity:"iOS",device:"iPad"},{key:"platform",subString:qn,identity:qn},{key:"userAgent",subString:"Android",identity:"Android"},{key:"platform",subString:"Linux",identity:"Linux"}];function Jn(e,t){for(var r,n=null,o=null,i="",a=0,s=t.length;a<s;a+=1)if(r=e[t[a].key],i=t[a].versionSearch||t[a].identity,r&&-1!==r.indexOf(t[a].subString)){n=t[a].identity,o=t[a].device;break}return{identity:n,device:o,versionSearchString:i}}function Yn(e,t){var r=e.indexOf(t);if(-1===r)return"";var n=e.substring(r+t.length+1).match(/[0-9]+(?:\.[0-9]*)?/);return n&&n.length?n[0]:""}var zn=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=window.navigator,r=Jn(t,Gn),n=Jn(t,Vn);this.browser=r.identity||"unknown",this.version=Yn(t.userAgent,r.versionSearchString)||Yn(t.appVersion,r.versionSearchString)||"unknown",this.OS=n.identity||"unknown",this.device=n.device||"unknown"}var t,r,n;return t=e,(r=[{key:"getName",value:function(){return this.browser}},{key:"getVersion",value:function(){return this.version}},{key:"isMinBrowser",value:function(e,t){return this.browser.toLowerCase()===e.toLowerCase()&&parseFloat(this.version)>=parseFloat(t)}},{key:"isSafari",value:function(){return this.browser===Kn}},{key:"isFirefox",value:function(){return this.browser===Xn}},{key:"isChrome",value:function(){return this.browser===Un}},{key:"isIE",value:function(){return this.browser===Wn}},{key:"isEdge",value:function(){return this.browser===Bn}},{key:"isIEAndSpecificBrowserPluginSupported",value:function(e){return this.isIE()&&function(e){var t=e||"htmlfile",r=!1;try{"ActiveXObject"in window&&(r=!!new(0,window.ActiveXObject)(t))}catch(e){r=!1}return r}(e)}}])&&Mn(t.prototype,r),n&&Mn(t,n),e}());var Qn=function(e){var t,r=[],n=0;return new Promise((function(o,i){e.forEach((function(a,s){a.then(o).catch(function(o){return function(a){r[o]=a,(n+=1)===e.length&&(t=new Error("no promises resolved"),i(t))}}(s))}))}))},Zn="safari_channel",$n="BoxEdit",eo="box_edit_not_supported_error",to="box_edit_uninstalled_error",ro="box_edit_upgrade_browser_error",no="box_edit_safari_error",oo="Box.BoxTools",io="http://127.0.0.1:",ao="activex_channel",so="http_channel",co="status",uo="application_request",lo="application_command",fo="uncreated",po="created",ho="active",yo="box_extension_output",bo="BOX-EXT-REQ-ID-",mo=408,vo={A6P:1,AC:1,AS:1,ACR:1,ACTION:1,AIR:1,APP:1,AWK:1,BAT:1,BOXNOTE:1,CGI:1,CHM:1,CMD:1,COM:1,CSH:1,DEK:1,DLD:1,DS:1,EBM:1,ESH:1,EXE:1,EZS:1,FKY:1,FRS:1,FXP:1,GADGET:1,HMS:1,HTA:1,ICD:1,INX:1,IPF:1,ISU:1,JAR:1,JS:1,JSE:1,JSX:1,KIX:1,LNK:1,LUA:1,MCR:1,MEM:1,MPX:1,MS:1,MSI:1,MST:1,OBS:1,PAF:1,PEX:1,PIF:1,PL:1,PRC:1,PRG:1,PVD:1,PWC:1,PY:1,PYC:1,PYO:1,QPX:1,RBX:1,REG:1,RGS:1,ROX:1,RPJ:1,SCAR:1,SCR:1,SCRIPT:1,SCPT:1,SCT:1,SH:1,SHB:1,SHS:1,SPR:1,TLB:1,TMS:1,U3P:1,UDF:1,URL:1,VB:1,VBE:1,VBS:1,VBSCRIPT:1,WCM:1,WPK:1,WS:1,WSF:1,XQT:1};function go(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Eo=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_o(this,"buildNextRequestID",(function(){return"".concat(bo).concat(r.window.performance.now())})),_o(this,"buildDetailsObj",(function(e,t,n){var o=n.toString(),i={data:void 0,operation:e,properties:{application:r.appName,timeout:o},req_id:r.buildNextRequestID()};if(e!==co){if(!t)throw new TypeError("Data cannot be undefined for ".concat(e));i.data=t}return i})),this.appName=t,this.window=window}var t,r,n;return t=e,(r=[{key:"sendCommand",value:function(e,t,r){return Promise.resolve("TODO")}},{key:"sendRequest",value:function(e,t,r){return Promise.resolve("TODO")}},{key:"getComServerStatus",value:function(e,t){return Promise.resolve("TODO")}},{key:"destroy",value:function(){}}])&&go(t.prototype,r),n&&go(t,n),e}();function Oo(e){return(Oo="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ko(e){return(ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Co(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Po(e,t){return(Po=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var So=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==Oo(t)&&"function"!==typeof t?Co(e):t}(this,ko(t).call(this,e)),wo(Co(n),"executeOperation",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Promise((function(i,a){var s=n.buildDetailsObj(e,t,o),c=setTimeout((function(){a(new Error({status_code:mo}))}),r);n.reqIdToPromiseMap.set(s.req_id,{resolve:i,rejectTimeout:c}),n.executeActiveXEvent({detail:s})}))})),wo(Co(n),"repairActiveXConnection",(function(e){zn.isIEAndSpecificBrowserPluginSupported(oo)&&(n.retryAttempt>=2||(n.retryAttempt+=1,setTimeout((function(){n.executeActiveXEvent(e)}),100)))})),wo(Co(n),"executeActiveXEvent",(function(e){var t=n.createActiveXObjectJSRef(),r="ExecuteSync"in t;try{n.isSynchronous&&r?t.ExecuteSync(JSON.stringify(e)):t.Execute(JSON.stringify(e))}catch(t){n.repairActiveXConnection(e)}})),wo(Co(n),"createActiveXObjectJSRef",(function(){return new(0,n.window.ActiveXObject)(oo)})),wo(Co(n),"setupActiveXCommunication",(function(){n.isActiveXExtensionListenerAttached||(n.document.addEventListener(yo,n.appExtensionEventResponseHandler),n.isActiveXExtensionListenerAttached=!0)})),wo(Co(n),"tearDownActiveXCommunication",(function(){n.isActiveXExtensionListenerAttached&&(n.document.removeEventListener(yo,n.appExtensionEventResponseHandler),n.isActiveXExtensionListenerAttached=!1)})),wo(Co(n),"appExtensionEventResponseHandler",(function(e){n.retryAttempt>0&&(n.retryAttempt=0);var t="string"===typeof e.detail?JSON.parse(e.detail):e.detail;if(n.reqIdToPromiseMap.has(t.req_id)){var r=n.reqIdToPromiseMap.get(t.req_id);if(r){clearTimeout(r.rejectTimeout),n.reqIdToPromiseMap.delete(t.req_id);var o="string"===typeof t.com_server_response.data?JSON.parse(t.com_server_response.data):t.com_server_response.data;r.resolve(o)}}})),wo(Co(n),"getComServerStatus",(function(e,t){return n.executeOperation(co,null,e,t)})),wo(Co(n),"sendRequest",(function(e,t,r){return n.executeOperation(uo,e,t,r)})),wo(Co(n),"sendCommand",(function(e,t,r){return n.executeOperation(lo,e,t,r)})),wo(Co(n),"destroy",(function(){n.tearDownActiveXCommunication()})),n.isSynchronous=r,n.channelName=ao,n.reqIdToPromiseMap=new Map,n.isActiveXExtensionListenerAttached=!1,n.retryAttempt=0,n.document=document,n.window=window,n.setupActiveXCommunication(),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Po(e,t)}(t,e),t}(Eo),Ao=r("03vecjQMf5");function Io(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"/",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=window,a=i.document,s=new Date,c=[];"undefined"===typeof r&&(r=s.getTime()+5184e6),s.setTime(r),c.push("".concat(e,"=").concat(encodeURIComponent(t))),0!==r&&c.push("; expires=".concat(s.toUTCString())),c.push("; path=".concat(n)),o&&c.push("; domain=".concat(o)),c.push("; secure"),a.cookie=c.join("")}function To(e){return(To="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ro(e){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Do(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jo(e,t){return(jo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Lo=new Ao.a;function Fo(){return Lo.getItem("comUseFallback")?{primary:17224,fallback:17223}:{primary:17223,fallback:17224}}var No=function(e){function t(e,r,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==To(t)&&"function"!==typeof t?Do(e):t}(this,Ro(t).call(this,e)),xo(Do(o),"createCORSRequest",(function(e,t){var r;try{return(r=new(0,o.window.XMLHttpRequest)).open(e,t,!0),r}catch(r){if(o.retryCounter<3)return o.retryCounter+=1,o.createCORSRequest(e,t);throw new Error("could not create xhr")}})),xo(Do(o),"getComServerStatusInstallationPromise",(function(e){var t,r,n=new Promise((function(e,n){t=e,r=n})),i=function(e,r){o.currentPort=e,17223===e?Lo.removeItem("comUseFallback"):Lo.setItem("comUseFallback",1),o.comServerInstallationPromiseRejected=!1,t(r)},a=Fo(),s=a.primary,c=a.fallback;return o.checkInstallStatus(s,e).then(i.bind(Do(o),s)).catch((function(t){if("notrunning"===t)return o.comServerInstallationPromiseRejected=!0,void r();o.checkInstallStatus(c,e).then(i.bind(Do(o),c)).catch((function(){o.comServerInstallationPromiseRejected=!0,r()}))})),n})),xo(Do(o),"sendComServerRequest",(function(e,t,r,n){return new Promise((function(i,a){try{var s=o.createCORSRequest(e,t);s.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),s.onload=function(){i(s)},s.onerror=function(){a(s)},n>0&&(s.timeout=n,s.ontimeout=function(){a(s)}),setTimeout((function(){s.send(r)}),0)}catch(e){a()}}))})),xo(Do(o),"checkInstallStatus",(function(e,t){return o.sendComServerRequest("GET","".concat(o.url).concat(e,"/status"),null,t).then((function(e){var t=JSON.parse(e.responseText);if(t.running)return t;throw o.comServerInstallationPromiseRejected=!0,new Error("notrunning")}))})),xo(Do(o),"getComChannel",(function(e){return function(e){var t,r,n=window.document.cookie.split("; "),o=n.length;for(r=0;r<o;r+=1)if((t=n[r].split("="))[0]===e)return t[1]?decodeURIComponent(t[1]):"";return""}("".concat(e,"-bgp-id"))})),xo(Do(o),"setComChannel",(function(e){var t=o.getComChannel(e)||o.generateId(),r="bgp-".concat(t),n=(new Date).getTime()+31536e6;return Io("".concat(e,"-bgp-id"),t,n),Io("bgp-".concat(t),"generic",n),r})),xo(Do(o),"getComServerStatus",(function(e){return!o.comServerInstallationPromise||o.comServerInstallationPromiseRejected?(o.comServerInstallationPromise=null,o.comServerInstallationPromise=o.getComServerStatusInstallationPromise(e),o.comServerInstallationPromise):o.comServerInstallationPromise})),xo(Do(o),"sendRequest",(function(e,t,r){var n="".concat(o.url).concat(o.currentPort,"/application_request?application=").concat(o.appName,"&com=").concat(o.comChannelName,"&timeout=").concat(r);return o.sendComServerRequest("POST",n,e,t).then((function(e){var t=JSON.parse(e.responseText);if(t.response_type&&"error"===t.response_type)throw new Error("Communication error: ".concat(t.message));return t}))})),xo(Do(o),"sendCommand",(function(e,t,r){var n="".concat(o.url).concat(o.currentPort,"/application_command?application=").concat(o.appName,"&com=").concat(o.comChannelName,"&timeout=").concat(r);return o.sendComServerRequest("POST",n,e,t).then((function(e){return JSON.parse(e.responseText)}))})),xo(Do(o),"generateId",(function(){var e=(new Date).getTime();return"xxxxxxxx".replace(/x/g,(function(){return Math.floor((e+16*Math.random())%16).toString(16)}))})),o.url=r,o.comChannelName=o.setComChannel(e),o.channelName=n,o.comServerInstallationPromise=null,o.comServerInstallationPromiseRejected=!1,o.retryCounter=0,o.sendCount=0,o.currentPort=Fo().primary,o.window=window,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jo(e,t)}(t,e),t}(Eo);function Ho(e){return(Ho="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mo(e){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bo(e,t){return(Bo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xo(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var qo=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=function(e,t){return!t||"object"!==Ho(t)&&"function"!==typeof t?Uo(e):t}(this,Mo(t).call(this,e)),Xo(Uo(r),"executeOperation",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Promise((function(i,a){var s=r.buildDetailsObj(e,t,o),c=setTimeout((function(){a(new Error({status_code:mo}))}),n);r.reqIdToPromiseMap.set(s.req_id,{resolve:i,rejectTimeout:c}),r.createAndDispatchAppExtensionEvent({detail:s})}))})),Xo(Uo(r),"setupSafariExtensionCommunication",(function(){r.isAppExtensionListenerAttached||(r.isAppExtensionListenerAttached=!0,r.document.addEventListener("box_extension_output",r.appExtensionEventResponseHandler))})),Xo(Uo(r),"tearDownSafariExtensionCommunication",(function(){r.isAppExtensionListenerAttached&&(r.isAppExtensionListenerAttached=!1,r.document.removeEventListener("box_extension_output",r.appExtensionEventResponseHandler))})),Xo(Uo(r),"appExtensionEventResponseHandler",(function(e){var t="string"===typeof e.detail?JSON.parse(e.detail):e.detail;if(r.reqIdToPromiseMap.has(t.req_id)){var n=r.reqIdToPromiseMap.get(t.req_id);if(n){clearTimeout(n.rejectTimeout),r.reqIdToPromiseMap.delete(t.req_id);var o="string"===typeof t.com_server_response.data?JSON.parse(t.com_server_response.data):t.com_server_response.data;n.resolve(o)}}})),Xo(Uo(r),"createAndDispatchAppExtensionEvent",(function(e){var t=new(0,r.window.CustomEvent)("box_extension_input",e);r.document.dispatchEvent(t)})),Xo(Uo(r),"getComServerStatus",(function(e,t){return r.executeOperation(co,null,e,t)})),Xo(Uo(r),"sendRequest",(function(e,t,n){return r.executeOperation(uo,e,t,n)})),Xo(Uo(r),"sendCommand",(function(e,t,n){return r.executeOperation(lo,e,t,n)})),Xo(Uo(r),"destroy",(function(){r.tearDownSafariExtensionCommunication()})),r.reqIdToPromiseMap=new Map,r.channelName=Zn,r.window=window,r.document=document,r.setupSafariExtensionCommunication(),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bo(e,t)}(t,e),t}(Eo);function Ko(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Wo;function Go(e){var t=io,r=po,n=so;return Wo.http_channel_status=r,new No(e,t,n)}function Vo(e){var t=po;return Wo.safari_channel_status=t,new qo(e)}function Jo(e){var t=po;return Wo.activex_channel_status=t,new So(e,!0)}function Yo(){var e=Bn;return zn.isMinBrowser(e,"17.17134")||zn.isMinBrowser(e,"16.16299")&&zn.getVersion().startsWith("16.")}function zo(){return zn.isEdge()&&!Yo()}function Qo(){var e=Un,t=Xn;return zn.isMinBrowser(e,53)||zn.isMinBrowser(t,55)||Yo()}function Zo(){return zn.isMinBrowser(Kn,10)}function $o(){return zn.isMinBrowser(Wn,11)}function ei(e){var t=no,r=to,n=ro,o=eo;return Qo()?o=r:$o()?o=r:zn.isFirefox()||zn.isChrome()||zn.isSafari()&&!Zo()||zo()?o=n:Zo()&&(o=t),Wo.error_message=o,e(new Error(o))}function ti(e){var t=5e3;return"number"===typeof e&&e>=0&&(t=Math.floor(e)),t}function ri(e){var t=+(e/1e3).toFixed(2);return e<2?t/=2:t-=1,t}var ni=function(){function e(t){var r,n,o,i,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),o=!1,(n="isInitialized")in(r=this)?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,this.channels=[],this.isInitialized=!0,i=zn.getName(),a=zn.getVersion(),Wo={box_tools_version:null,browser_name:i,browser_version:a,error_message:null,installation_type:null,http_channel_status:fo,https_channel_status:fo,activex_channel_status:fo,safari_channel_status:fo},Qo()?this.channels.push(Go(t)):Zo()?this.channels.push(Vo(t)):$o()&&zn.isIEAndSpecificBrowserPluginSupported(oo)?this.channels.push(function(e){var t=po;return Wo.activex_channel_status=t,new So(e,!1)}(t)):zn.isFirefox()&&!zn.isMinBrowser(Xn,55)||zo()||(this.channels=this.channels.concat([Go(t),Vo(t),Jo(t)]))}var t,r,n;return t=e,(r=[{key:"getComServerStatus",value:function(e){var t=this,r=ho,n=ti(e),o=ri(n),i=zo();return new Promise((function(e,a){return i?ei.call(null,a):t.channels.length?Qn(t.channels.map((function(i){return i.getComServerStatus(n,o).then((function(n){return t.activeChannel=i,n&&(Wo.installation_type=n.installation_type,Wo.box_tools_version=n.version),Wo["".concat(i.channelName,"_status")]=r,e(n)}))}))).catch(ei.bind(null,a)):ei.call(null,a)}))}},{key:"sendRequest",value:function(e,t,r){var n=this,o=ti(r),i=ri(o);return this.activeChannel?this.activeChannel.sendRequest(e,o,i):this.getComServerStatus().then((function(){return n.activeChannel.sendRequest(e,o,i)}))}},{key:"sendCommand",value:function(e,t){var r=this,n=ti(t),o=ri(n);return this.activeChannel?this.activeChannel.sendCommand(e,n,o):this.getComServerStatus().then((function(){return r.activeChannel.sendCommand(e,n,o)}))}}])&&Ko(t.prototype,r),n&&Ko(t,n),e}();function oi(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ii(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function ai(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ii(i,n,o,a,s,"next",e)}function s(e){ii(i,n,o,a,s,"throw",e)}a(void 0)}))}}function si(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ci;var ui=null,li=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ui instanceof e||(ui=this),this.extensionRequestQueue=new Map,ui}var t,r,n,o;return t=e,(r=[{key:"queueGetNativeAppNameFromLocal",value:function(e){if(this.extensionRequestQueue.has(e)){var t=this.extensionRequestQueue.get(e);if(!t)throw new Error("Race condition re: queueGetNativeAppNameFromLocal");return t.promise}var r={},n=new Promise((function(e,t){r.resolve=e,r.reject=t}));return r.promise=n,this.extensionRequestQueue.set(e,r),n}},{key:"checkBoxEditAvailability",value:function(){return this.getBoxEditAvailability()}},{key:"getBoxEditAvailability",value:function(){return this.client=new ni($n),this.client.getComServerStatus()}},{key:"canOpenWithBoxEdit",value:(o=ai(regeneratorRuntime.mark((function e(t){var r,n,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map(function(){var e=ai(regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.getAppForExtension(t);case 3:return r=e.sent,n=[t,r],e.abrupt("return",n);case 8:return e.prev=8,e.t0=e.catch(0),i=[t,""],e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()));case 2:return r=e.sent,n=new Map,r.forEach((function(e){return n.set.apply(n,oi(e))})),e.abrupt("return",Promise.resolve(n));case 6:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"openFile",value:function(e,t){var r=function(e,t,r,n){return JSON.stringify({auth_code:r,auth_token:t,browser_type:zn.getName(),command_type:"launch_application",file_id:e.toString(),token_scope:n})}(e,t.data.token,t.data.auth_code,t.data.token_scope);return this.client.sendCommand(r,5e3)}},{key:"getAppForExtension",value:function(e){var t=this;try{if(function(e){var t=vo,r=e.toUpperCase();return"."===r.charAt(0)&&(r=r.substr(1)),r in t}(e))throw new Error("blacklisted");var r=this.queueGetNativeAppNameFromLocal(e);return ci||(ci=setTimeout((function(){t.processExtensionRequestQueue()}),100)),r}catch(e){return Promise.reject()}}},{key:"processExtensionRequestQueue",value:function(){var e=new Map,t=[];this.extensionRequestQueue.forEach((function(r,n){e.set(n,r),t.push(n)})),this.extensionRequestQueue.clear(),ci=null;var r=function(e){return JSON.stringify({request_type:"get_default_application",extension:e})}(t);return this.client.sendRequest(r).then((function(r){if(r&&r.default_application_name){var n=r.default_application_name;"[object Object]"===Object.prototype.toString.call(n)&&(n=[n]),n.forEach((function(t){var r=Object.keys(t)[0],n=decodeURIComponent(t[r]);if(n){var o=e.get(r);o&&(o.resolve(n),e.delete(r))}}))}t.forEach((function(t){var r=e.get(t);r&&r.reject()}))}))}}])&&si(t.prototype,r),n&&si(t,n),e}();function fi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var di=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fi(Object(r),!0).forEach((function(t){pi(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{apiHost:t.apiHost||A.DEFAULT_HOSTNAME_API,uploadHost:t.uploadHost||A.DEFAULT_HOSTNAME_UPLOAD,cache:t.cache||new n.a,language:t.language})}var t,r,i;return t=e,(r=[{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.fileAPI&&(this.fileAPI.destroy(),delete this.fileAPI),this.weblinkAPI&&(this.weblinkAPI.destroy(),delete this.weblinkAPI),this.plainUploadAPI&&(this.plainUploadAPI.destroy(),delete this.plainUploadAPI),this.chunkedUploadAPI&&(this.chunkedUploadAPI.destroy(),delete this.chunkedUploadAPI),this.folderAPI&&(this.folderAPI.destroy(),delete this.folderAPI),this.searchAPI&&(this.searchAPI.destroy(),delete this.searchAPI),this.recentsAPI&&(this.recentsAPI.destroy(),delete this.recentsAPI),this.versionsAPI&&(this.versionsAPI.destroy(),delete this.versionsAPI),this.fileAccessStatsAPI&&(this.fileAccessStatsAPI.destroy(),delete this.fileAccessStatsAPI),this.tasksNewAPI&&(this.tasksNewAPI.destroy(),delete this.tasksNewAPI),this.taskCollaboratorsAPI&&(this.taskCollaboratorsAPI.destroy(),delete this.taskCollaboratorsAPI),this.taskLinksAPI&&(this.taskLinksAPI.destroy(),delete this.taskLinksAPI),this.commentsAPI&&(this.commentsAPI.destroy(),delete this.commentsAPI),this.usersAPI&&(this.usersAPI.destroy(),delete this.usersAPI),this.metadataAPI&&(this.metadataAPI.destroy(),delete this.metadataAPI),this.fileCollaboratorsAPI&&(this.fileCollaboratorsAPI.destroy(),delete this.fileCollaboratorsAPI),this.appIntegrationsAPI&&(this.appIntegrationsAPI.destroy(),delete this.appIntegrationsAPI),this.metadataQueryAPI&&(this.metadataQueryAPI.destroy(),delete this.metadataQueryAPI),this.openWithAPI&&(this.openWithAPI.destroy(),delete this.openWithAPI),this.annotationsAPI&&(this.annotationsAPI.destroy(),delete this.annotationsAPI),e&&(this.options.cache=new n.a)}},{key:"getCache",value:function(){return this.options.cache}},{key:"getAPI",value:function(e){var t;switch(e){case A.TYPE_FOLDER:t=this.getFolderAPI();break;case A.TYPE_FILE:t=this.getFileAPI();break;case A.TYPE_WEBLINK:t=this.getWebLinkAPI();break;default:throw new Error("Unknown Type!")}return t}},{key:"getFileAPI",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e&&this.destroy(),this.fileAPI=new O.a(this.options),this.fileAPI}},{key:"getWebLinkAPI",value:function(){return this.destroy(),this.weblinkAPI=new k.a(this.options),this.weblinkAPI}},{key:"getPlainUploadAPI",value:function(){return this.destroy(),this.plainUploadAPI=new _(this.options),this.plainUploadAPI}},{key:"getChunkedUploadAPI",value:function(){return this.destroy(),this.chunkedUploadAPI=new o.a(this.options),this.chunkedUploadAPI}},{key:"getFolderAPI",value:function(){return this.destroy(),this.folderAPI=new E.a(this.options),this.folderAPI}},{key:"getSearchAPI",value:function(){return this.destroy(),this.searchAPI=new M(this.options),this.searchAPI}},{key:"getRecentsAPI",value:function(){return this.destroy(),this.recentsAPI=new Y(this.options),this.recentsAPI}},{key:"getMetadataAPI",value:function(e){return e&&this.destroy(),this.metadataAPI=new Zt(this.options),this.metadataAPI}},{key:"getVersionsAPI",value:function(e){return e&&this.destroy(),this.versionsAPI=new ke(this.options),this.versionsAPI}},{key:"getCommentsAPI",value:function(e){return e&&this.destroy(),this.commentsAPI=new xe(this.options),this.commentsAPI}},{key:"getTasksNewAPI",value:function(e){return e&&this.destroy(),this.tasksNewAPI=new $e(this.options),this.tasksNewAPI}},{key:"getTaskCollaboratorsAPI",value:function(e){return e&&this.destroy(),this.taskCollaboratorsAPI=new ft(this.options),this.taskCollaboratorsAPI}},{key:"getTaskLinksAPI",value:function(e){return e&&this.destroy(),this.taskLinksAPI=new Et(this.options),this.taskLinksAPI}},{key:"getFileAccessStatsAPI",value:function(e){return e&&this.destroy(),this.fileAccessStatsAPI=new At(this.options),this.fileAccessStatsAPI}},{key:"getFileCollaboratorsAPI",value:function(e){return e&&this.destroy(),this.fileCollaboratorsAPI=new Er(this.options),this.fileCollaboratorsAPI}},{key:"getUsersAPI",value:function(e){return e&&this.destroy(),this.usersAPI=new Mt(this.options),this.usersAPI}},{key:"getFeedAPI",value:function(e){return e&&this.destroy(),this.feedItemsAPI=new dn(this.options),this.feedItemsAPI}},{key:"getOpenWithAPI",value:function(e){return e&&this.destroy(),this.openWithAPI=new In(this.options),this.openWithAPI}},{key:"getAppIntegrationsAPI",value:function(e){return e&&this.destroy(),this.appIntegrationsAPI=new En(this.options),this.appIntegrationsAPI}},{key:"getMetadataQueryAPI",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e&&this.destroy(),this.metadataQueryAPI=new Hn(this.options),this.metadataQueryAPI}},{key:"getBoxEditAPI",value:function(){return this.boxEditAPI=new li,this.boxEditAPI}},{key:"getAnnotationsAPI",value:function(e){return e&&this.destroy(),this.annotationsAPI=new Lr(this.options),this.annotationsAPI}}])&&hi(t.prototype,r),i&&hi(t,i),e}();t.a=di},BSXSWhc9DH:function(e,t,r){"use strict";var n=r("QkVNESsdth"),o=r.n(n);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache={}}var t,r,n;return t=e,(r=[{key:"set",value:function(e,t){this.cache[e]=t}},{key:"merge",value:function(e,t){if(!this.has(e))throw new Error("Key ".concat(e," not in cache!"));this.set(e,o()({},this.get(e),t))}},{key:"unset",value:function(e){delete this.cache[e]}},{key:"unsetAll",value:function(e){var t=this;Object.keys(this.cache).forEach((function(r){r.startsWith(e)&&delete t.cache[r]}))}},{key:"has",value:function(e){return{}.hasOwnProperty.call(this.cache,e)}},{key:"get",value:function(e){if(this.has(e))return this.cache[e]}}])&&i(t.prototype,r),n&&i(t,n),e}();t.a=a},BkRInKdPEO:function(e,t,r){var n=r("OBhPXHkRcd");e.exports=function(e){return n(e,5)}},D1y2Gn20OY:function(e,t,r){var n=r("FZooccv/8F");e.exports=function(e,t,r){return null==e?e:n(e,t,r)}},DUBYMsvOMy:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("YZm+6poGny"),o=r.n(n);function i(){return window.crypto||window.msCrypto}function a(e,t){var r=i();return r!==window.msCrypto?r.subtle.digest(e,t):new Promise((function(n,i){if("SHA-1"===e)try{var a=o.a.arrayBuffer(t);n(a)}catch(e){i(e)}else{var s=r.subtle.digest({name:e},t);s.oncomplete=function(e){n(e.target.result)},s.onerror=i}}))}},FK3KWhmfP1:function(e,t,r){"use strict";var n=r("vN+2IcUykn"),o=r.n(n),i=r("GODclIc8p8"),a=r.n(i),s=r("YrhTq/oyJV"),c=r("BweDcK5eOp"),u=r("DUBYMsvOMy");function l(e,t,r){"use asm";var n=new e.Int32Array(r);function o(e,t){e=e|0;t=t|0;var r=0,o=0,i=0,a=0,s=0,c=0,u=0,l=0,f=0,p=0,h=0,d=0,y=0,b=0;i=n[t+320>>2]|0;s=n[t+324>>2]|0;u=n[t+328>>2]|0;f=n[t+332>>2]|0;h=n[t+336>>2]|0;for(r=0;(r|0)<(e|0);r=r+64|0){a=i;c=s;l=u;p=f;d=h;for(o=0;(o|0)<64;o=o+4|0){b=n[r+o>>2]|0;y=((i<<5|i>>>27)+(s&u|~s&f)|0)+((b+h|0)+1518500249|0)|0;h=f;f=u;u=s<<30|s>>>2;s=i;i=y;n[e+o>>2]=b}for(o=e+64|0;(o|0)<(e+80|0);o=o+4|0){b=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;y=((i<<5|i>>>27)+(s&u|~s&f)|0)+((b+h|0)+1518500249|0)|0;h=f;f=u;u=s<<30|s>>>2;s=i;i=y;n[o>>2]=b}for(o=e+80|0;(o|0)<(e+160|0);o=o+4|0){b=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;y=((i<<5|i>>>27)+(s^u^f)|0)+((b+h|0)+1859775393|0)|0;h=f;f=u;u=s<<30|s>>>2;s=i;i=y;n[o>>2]=b}for(o=e+160|0;(o|0)<(e+240|0);o=o+4|0){b=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;y=((i<<5|i>>>27)+(s&u|s&f|u&f)|0)+((b+h|0)-1894007588|0)|0;h=f;f=u;u=s<<30|s>>>2;s=i;i=y;n[o>>2]=b}for(o=e+240|0;(o|0)<(e+320|0);o=o+4|0){b=(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])<<1|(n[o-12>>2]^n[o-32>>2]^n[o-56>>2]^n[o-64>>2])>>>31;y=((i<<5|i>>>27)+(s^u^f)|0)+((b+h|0)-899497514|0)|0;h=f;f=u;u=s<<30|s>>>2;s=i;i=y;n[o>>2]=b}i=i+a|0;s=s+c|0;u=u+l|0;f=f+p|0;h=h+d|0}n[t+320>>2]=i;n[t+324>>2]=s;n[t+328>>2]=u;n[t+332>>2]=f;n[t+336>>2]=h}return{hash:o}}var f=function(){var e=new Blob(["const RushaCore = ".concat(l.toString()),";\n",'function Rusha(e){for(var r=function(e){if("string"==typeof e)return"string";if(e instanceof Array)return"array";if("undefined"!=typeof global&&global.Buffer&&global.Buffer.isBuffer(e))return"buffer";if(e instanceof ArrayBuffer)return"arraybuffer";if(e.buffer instanceof ArrayBuffer)return"view";if(e instanceof Blob)return"blob";throw new Error("Unsupported data type.")},n={fill:0},t=function(e){for(e+=9;e%64>0;e+=1);return e},a=function(e,r,n,t,a){var f,s=this,i=a%4,h=(t+i)%4,u=t-h;switch(i){case 0:e[a]=s[n+3];case 1:e[a+1-(i<<1)|0]=s[n+2];case 2:e[a+2-(i<<1)|0]=s[n+1];case 3:e[a+3-(i<<1)|0]=s[n]}if(!(t<h+i)){for(f=4-i;f<u;f=f+4|0)r[a+f>>2|0]=s[n+f]<<24|s[n+f+1]<<16|s[n+f+2]<<8|s[n+f+3];switch(h){case 3:e[a+u+1|0]=s[n+u+2];case 2:e[a+u+2|0]=s[n+u+1];case 1:e[a+u+3|0]=s[n+u]}}},f=function(e){switch(r(e)){case"string":return function(e,r,n,t,a){var f,s=this,i=a%4,h=(t+i)%4,u=t-h;switch(i){case 0:e[a]=s.charCodeAt(n+3);case 1:e[a+1-(i<<1)|0]=s.charCodeAt(n+2);case 2:e[a+2-(i<<1)|0]=s.charCodeAt(n+1);case 3:e[a+3-(i<<1)|0]=s.charCodeAt(n)}if(!(t<h+i)){for(f=4-i;f<u;f=f+4|0)r[a+f>>2]=s.charCodeAt(n+f)<<24|s.charCodeAt(n+f+1)<<16|s.charCodeAt(n+f+2)<<8|s.charCodeAt(n+f+3);switch(h){case 3:e[a+u+1|0]=s.charCodeAt(n+u+2);case 2:e[a+u+2|0]=s.charCodeAt(n+u+1);case 1:e[a+u+3|0]=s.charCodeAt(n+u)}}}.bind(e);case"array":case"buffer":return a.bind(e);case"arraybuffer":return a.bind(new Uint8Array(e));case"view":return a.bind(new Uint8Array(e.buffer,e.byteOffset,e.byteLength));case"blob":return function(e,r,n,t,a){var f,s=a%4,i=(t+s)%4,h=t-i,u=new Uint8Array(reader.readAsArrayBuffer(this.slice(n,n+t)));switch(s){case 0:e[a]=u[3];case 1:e[a+1-(s<<1)|0]=u[2];case 2:e[a+2-(s<<1)|0]=u[1];case 3:e[a+3-(s<<1)|0]=u[0]}if(!(t<i+s)){for(f=4-s;f<h;f=f+4|0)r[a+f>>2|0]=u[f]<<24|u[f+1]<<16|u[f+2]<<8|u[f+3];switch(i){case 3:e[a+h+1|0]=u[h+2];case 2:e[a+h+2|0]=u[h+1];case 1:e[a+h+3|0]=u[h]}}}.bind(e)}},s=new Array(256),i=0;i<256;i++)s[i]=(i<16?"0":"")+i.toString(16);var h=function(e){for(var r=new Uint8Array(e),n=new Array(e.byteLength),t=0;t<n.length;t++)n[t]=s[r[t]];return n.join("")};!function(e){if(e%64>0)throw new Error("Chunk size must be a multiple of 128 bit");n.offset=0,n.maxChunkLen=e,n.padMaxChunkLen=t(e),n.heap=new ArrayBuffer(function(e){var r;if(e<=65536)return 65536;if(e<16777216)for(r=1;r<e;r<<=1);else for(r=16777216;r<e;r+=16777216);return r}(n.padMaxChunkLen+320+20)),n.h32=new Int32Array(n.heap),n.h8=new Int8Array(n.heap),n.core=new RushaCore({Int32Array:Int32Array,DataView:DataView},{},n.heap),n.buffer=null}(e||65536);var u=function(e,r){n.offset=0;var t=new Int32Array(e,r+320,5);t[0]=1732584193,t[1]=-271733879,t[2]=-1732584194,t[3]=271733878,t[4]=-1009589776},c=function(e,r){var a,f,s,i=t(e),h=new Int32Array(n.heap,0,i>>2);return function(e,r){var n=new Uint8Array(e.buffer),t=r%4,a=r-t;switch(t){case 0:n[a+3]=0;case 1:n[a+2]=0;case 2:n[a+1]=0;case 3:n[a+0]=0}for(var f=1+(r>>2);f<e.length;f++)e[f]=0}(h,e),s=r,(a=h)[(f=e)>>2]|=128<<24-(f%4<<3),a[14+(2+(f>>2)&-16)]=s/(1<<29)|0,a[15+(2+(f>>2)&-16)]=s<<3,i},o=function(e,r,t,a){f(e)(n.h8,n.h32,r,t,a||0)},d=function(e,r,t,a,f){var s=t;o(e,r,t),f&&(s=c(t,a)),n.core.hash(s,n.padMaxChunkLen)},y=function(e,r){var n=new Int32Array(e,r+320,5),t=new Int32Array(5),a=new DataView(t.buffer);return a.setInt32(0,n[0],!1),a.setInt32(4,n[1],!1),a.setInt32(8,n[2],!1),a.setInt32(12,n[3],!1),a.setInt32(16,n[4],!1),t},w=this.rawDigest=function(e){var r=e.byteLength||e.length||e.size||0;u(n.heap,n.padMaxChunkLen);var t=0,a=n.maxChunkLen;for(t=0;r>t+a;t+=a)d(e,t,a,r,!1);return d(e,t,r-t,r,!0),y(n.heap,n.padMaxChunkLen)};this.digest=this.digestFromString=this.digestFromBuffer=this.digestFromArrayBuffer=function(e){return h(w(e).buffer)},this.resetState=function(){return u(n.heap,n.padMaxChunkLen),this},this.append=function(e){var r,t=0,a=e.byteLength||e.length||e.size||0,f=n.offset%n.maxChunkLen;for(n.offset+=a;t<a;)r=Math.min(a-t,n.maxChunkLen-f),o(e,t,r,f),t+=r,(f+=r)===n.maxChunkLen&&(n.core.hash(n.maxChunkLen,n.padMaxChunkLen),f=0);return this},this.getState=function(){var e;if(n.offset%n.maxChunkLen)e=n.heap.slice(0);else{var r=new Int32Array(n.heap,n.padMaxChunkLen+320,5);e=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}return{offset:n.offset,heap:e}},this.setState=function(e){(n.offset=e.offset,20===e.heap.byteLength)?new Int32Array(n.heap,n.padMaxChunkLen+320,5).set(new Int32Array(e.heap)):n.h32.set(new Int32Array(e.heap));return this};var p=this.rawEnd=function(){var e=n.offset,r=e%n.maxChunkLen,t=c(r,e);n.core.hash(t,n.padMaxChunkLen);var a=y(n.heap,n.padMaxChunkLen);return u(n.heap,n.padMaxChunkLen),a};this.end=function(){return h(p().buffer)}}',";\n","var setupWorker = ",function(){var e=new Rusha;e.resetState();var t=0;self.onmessage=function(r){var n=r.data,o=n.part,i=n.fileSize,a=n.partContents,s=Date.now();try{if(o.offset!==t)throw new Error("Out of order parts given to worker");if(e.append(a),self.postMessage({type:"partDone",part:n.part,duration:Date.now()-s,partContents:a},[a]),t+=o.size,o.offset+o.size===i){var c=e.end();self.postMessage({type:"done",sha1:c})}}catch(e){var u={type:"error",name:e.name,message:e.message,part:o};self.postMessage(u)}}}.toString(),";\n","setupWorker();"],{type:"text/javascript"}),t=(window.URL||window.webkitURL).createObjectURL(e),r=new Worker(t);return r.oldTerminate=r.terminate,r.terminate=function(){(window.URL||window.webkitURL).revokeObjectURL(t),r.oldTerminate()},r},p=r("8Wpvjplx0g"),h=r("mwIZSSbMl2"),d=r.n(h),y=r("TKn7jDHPZc"),b=r("fh8xsLuPZu");function m(e){return(m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t){return(E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var k={digestReadahead:5,initialRetryDelayMs:5e3,maxRetryDelayMs:6e4,parallelism:4,requestTimeoutMs:12e4,retries:5},C=function(e){function t(e,r,n){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=function(e,t){return!t||"object"!==m(t)&&"function"!==typeof t?_(e):t}(this,g(t).call(this,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e,{shouldRetry:!1}))),O(_(o),"logEvent",(function(e,t){var r={event_type:e};return t&&(r.event_info=t),o.xhr.post({url:o.sessionEndpoints.logEvent,data:r})})),o.config=n||k,o.sessionEndpoints=r,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E(e,t)}(t,e),t}(b.a);function P(e){return(P="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){w(i,n,o,a,s,"next",e)}function s(e){w(i,n,o,a,s,"throw",e)}a(void 0)}))}}function A(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=function(e){function t(e,r,n,i,a,u,l,f,h,b,m,v){var g;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),g=function(e,t){return!t||"object"!==P(t)&&"function"!==typeof t?T(e):t}(this,I(t).call(this,e,l,f)),D(T(g),"toJSON",(function(){return JSON.stringify({index:g.index,offset:g.offset,partSize:g.partSize,state:g.state,uploadedBytes:g.uploadedBytes,numUploadRetriesPerformed:g.numUploadRetriesPerformed,numDigestRetriesPerformed:g.numDigestRetriesPerformed,sha256:g.sha256,timing:g.timing})})),D(T(g),"getPart",(function(){return g.data.part||{}})),D(T(g),"upload",(function(){if(!g.isDestroyedOrPaused()){if(!g.sha256)throw new Error("Part SHA-256 unavailable");if(!g.blob)throw new Error("Part blob unavailable");var e={documentHidden:document.hidden,digest_retries:g.numDigestRetriesPerformed,timing:g.timing,parts_uploading:g.getNumPartsUploading()},t={"Content-Type":"application/octet-stream",Digest:"sha-256=".concat(g.sha256),"Content-Range":"bytes ".concat(g.offset,"-").concat(g.rangeEnd,"/").concat(g.fileSize),"X-Box-Client-Event-Info":JSON.stringify(e)};g.state=2,g.startTimestamp=Date.now(),g.xhr.uploadFile({url:g.sessionEndpoints.uploadPart,data:g.blob,headers:t,method:p.HTTP_PUT,successHandler:g.uploadSuccessHandler,errorHandler:g.uploadErrorHandler,progressHandler:g.uploadProgressHandler,withIdleTimeout:!0,idleTimeoutDuration:g.config.requestTimeoutMs})}})),D(T(g),"uploadSuccessHandler",(function(e){var t=e.data;g.isDestroyedOrPaused()||(g.state=3,g.consoleLog("Upload completed: ".concat(g.toJSON(),".")),g.data=t,g.blob=null,g.timing.uploadTime=Date.now()-g.startTimestamp,g.onSuccess(T(g)),g.uploadedBytes=g.partSize)})),D(T(g),"uploadProgressHandler",(function(e){if(!g.isDestroyedOrPaused()){var t=parseInt(e.loaded,10),r=g.uploadedBytes;g.uploadedBytes=t,g.onProgress(r,t)}})),D(T(g),"uploadErrorHandler",function(){var e=S(regeneratorRuntime.mark((function e(t){var r,n,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g.isDestroyedOrPaused()){e.next=2;break}return e.abrupt("return");case 2:if(r=d()(g.xhr,"xhr.readyState",null),n=d()(g.xhr,"xhr.statusText",""),g.consoleLog("Upload failure ".concat(t.message," for part ").concat(g.toJSON(),". XHR state: ").concat(r,".")),o={message:t.message,part:{uploadedBytes:g.uploadedBytes,id:g.id,index:g.index,offset:g.offset},xhr_ready_state:r,xhr_status_text:n},i=JSON.stringify(o),g.sessionEndpoints.logEvent?Object(c.a)((function(e,t){g.logEvent("part_failure",i).then(e).catch(t)}),g.config.retries,g.config.initialRetryDelayMs).catch((function(e){return g.consoleLog("Failure in logEvent: ".concat(e.message))})):g.consoleLog("logEvent endpoint not found"),!(g.numUploadRetriesPerformed>=g.config.retries)){e.next=11;break}return g.onError(t,i),e.abrupt("return");case 11:a=Object(s.getBoundedExpBackoffRetryDelay)(g.config.initialRetryDelayMs,g.config.maxRetryDelayMs,g.numUploadRetriesPerformed),g.numUploadRetriesPerformed+=1,g.consoleLog("Retrying uploading part ".concat(g.toJSON()," in ").concat(a," ms")),g.retryTimeout=setTimeout(g.retryUpload,a);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),D(T(g),"retryUpload",S(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!g.isDestroyedOrPaused()){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,g.listParts(g.index,1);case 5:if(!(t=e.sent)||1!==t.length||t[0].offset!==g.offset||!t[0].part_id){e.next=11;break}return g.consoleLog("Part ".concat(g.toJSON()," is available on server. Not re-uploading.")),g.id=t[0].part_id,g.uploadSuccessHandler({data:{part:t[0]}}),e.abrupt("return");case 11:throw g.consoleLog("Part ".concat(g.toJSON()," is not available on server. Re-uploading.")),new Error("Part not found on the server");case 15:e.prev=15,e.t0=e.catch(2),(r=e.t0.response)&&r.status&&g.consoleLog("Error ".concat(r.status," while listing part ").concat(g.toJSON(),". Re-uploading.")),g.numUploadRetriesPerformed+=1,g.upload();case 21:case"end":return e.stop()}}),e,null,[[2,15]])})))),D(T(g),"listParts",function(){var e=S(regeneratorRuntime.mark((function e(t,r){var n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={offset:t,limit:r},o=Object(y.a)(g.sessionEndpoints.listParts,n),e.next=4,g.xhr.get({url:o});case 4:return i=e.sent,e.abrupt("return",i.data.entries);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),g.index=r,g.numDigestRetriesPerformed=0,g.numUploadRetriesPerformed=0,g.offset=n,g.partSize=i,g.fileSize=a,g.state=0,g.timing={},g.uploadedBytes=0,g.data={},g.config=f,g.rangeEnd=n+i-1,g.rangeEnd>a-1&&(g.rangeEnd=a-1),g.isPaused=!1,g.onSuccess=b||o.a,g.onError=v||o.a,g.onProgress=m||o.a,g.getNumPartsUploading=h,g}var r,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,e),r=t,(n=[{key:"cancel",value:function(){clearTimeout(this.retryTimeout),this.blob=null,this.data={},this.destroy()}},{key:"pause",value:function(){clearTimeout(this.retryTimeout),this.isPaused=!0,this.state=1,this.xhr.abort()}},{key:"unpause",value:function(){this.isPaused=!1,this.state=2,this.retryUpload()}},{key:"reset",value:function(){this.numUploadRetriesPerformed=0,this.timing={},this.uploadedBytes=0}},{key:"isDestroyedOrPaused",value:function(){return this.isDestroyed()||this.isPaused}}])&&A(r.prototype,n),i&&A(r,i),t}(C);function x(e){return(x="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function N(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function H(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){N(i,n,o,a,s,"next",e)}function s(e){N(i,n,o,a,s,"throw",e)}a(void 0)}))}}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var K=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=function(e,t){return!t||"object"!==x(t)&&"function"!==typeof t?B(e):t}(this,U(t).call(this,e,{createSession:null,uploadPart:null,listParts:null,commit:null,abort:null,logEvent:null},r)),q(B(n),"getBaseUploadUrlFromPreflightResponse",(function(e){var t=e.data;if(!t||!t.upload_url)return n.getBaseUploadUrl();var r=t.upload_url.split("/");return n.uploadHost="".concat(r[0],"//").concat(r[2]),n.getBaseUploadUrl()})),q(B(n),"preflightSuccessHandler",function(){var e=H(regeneratorRuntime.mark((function e(t){var r,o,i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isDestroyed()){e.next=2;break}return e.abrupt("return");case 2:return r=n.getBaseUploadUrlFromPreflightResponse(t),(o="".concat(r,"/files/upload_sessions")).includes("fupload-ec2")&&(n.config.parallelism=1),i={file_size:n.file.size,file_name:n.fileName},n.fileId?o=o.replace("upload_sessions","".concat(n.fileId,"/upload_sessions")):i.folder_id=n.folderId,e.prev=7,e.next=10,n.xhr.post({url:o,data:i});case 10:a=e.sent,n.createSessionSuccessHandler(a.data),e.next=31;break;case 14:if(e.prev=14,e.t0=e.catch(7),!((s=n.getErrorResponse(e.t0))&&s.status>=500&&s.status<600)){e.next=20;break}return n.createSessionErrorHandler(e.t0),e.abrupt("return");case 20:if(!s||409!==s.status||"session_conflict"!==s.code){e.next=23;break}return n.createSessionSuccessHandler(s.context_info.session),e.abrupt("return");case 23:if(!(s&&s.status===p.HTTP_STATUS_CODE_FORBIDDEN&&s.code===p.ERROR_CODE_UPLOAD_STORAGE_LIMIT_EXCEEDED||s.status===p.HTTP_STATUS_CODE_FORBIDDEN&&"access_denied_insufficient_permissions"===s.code)){e.next=26;break}return n.errorCallback(s),e.abrupt("return");case 26:if(!s||409!==s.status){e.next=30;break}return n.resolveConflict(s),n.createSessionRetry(),e.abrupt("return");case 30:n.sessionErrorHandler(e.t0,"create_session_misc_error",JSON.stringify(e.t0));case 31:case"end":return e.stop()}}),e,null,[[7,14]])})));return function(t){return e.apply(this,arguments)}}()),q(B(n),"createSessionErrorHandler",(function(e){n.isDestroyed()||(n.createSessionNumRetriesPerformed<n.config.retries?n.createSessionRetry():(n.consoleLog("Too many create session failures, failing upload"),n.sessionErrorHandler(e,"create_session_retries_exceeded",JSON.stringify(e))))})),q(B(n),"getSessionInfo",H(regeneratorRuntime.mark((function e(){var t,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.getBaseUploadUrl(),r="".concat(t,"/files/upload_sessions/").concat(n.sessionId),e.prev=2,e.next=5,n.xhr.get({url:r});case 5:o=e.sent,n.getSessionSuccessHandler(o.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),n.getSessionErrorHandler(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))),q(B(n),"partUploadSuccessHandler",(function(e){n.numPartsUploading-=1,n.numPartsUploaded+=1,n.updateProgress(e.uploadedBytes,n.partSize),n.processNextParts()})),q(B(n),"partUploadErrorHandler",(function(e,t){if(n.sessionErrorHandler(e,"part_upload_retries_exceeded",t),n.isResumableUploadsEnabled)for(var r=n.firstUnuploadedPartIndex;n.numPartsUploading>0;){var o=n.parts[r];o&&2===o.state&&(o.reset(),o.pause(),n.numPartsUploading-=1,n.numPartsDigestReady+=1),r+=1}})),q(B(n),"updateProgress",(function(e,t){n.isDestroyed()||(n.totalUploadedBytes+=t-e,n.progressCallback({loaded:n.totalUploadedBytes,total:n.file.size}))})),q(B(n),"processNextParts",(function(){if(!n.failSessionIfFileChangeDetected())if(n.numPartsUploaded===n.parts.length&&n.fileSha1)n.commitSession();else{for(n.updateFirstUnuploadedPartIndex();n.canStartMorePartUploads();)n.uploadNextPart();n.shouldComputeDigestForNextPart()&&n.computeDigestForNextPart()}})),q(B(n),"onWorkerMessage",(function(e){if(!n.isDestroyed()){var t,r=e.data;if("partDone"===r.type){n.numPartsDigestComputing-=1;var o=r.part;n.parts[o.index].timing.fileDigestTime=r.duration,n.processNextParts()}else"done"===r.type?(n.fileSha1=(t=r.sha1,btoa(String.fromCharCode.apply(null,t.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")))),n.sha1Worker.terminate(),n.processNextParts()):"error"===r.type&&n.sessionErrorHandler(null,"web_worker_error",JSON.stringify(r))}})),q(B(n),"sendPartToWorker",(function(e,t){if(!n.isDestroyed()){var r={index:e.index,offset:e.offset,size:e.partSize};n.sha1Worker.postMessage({part:r,fileSize:n.file.size,partContents:t},[t]),n.consoleLog("Part sent to worker: ".concat(JSON.stringify(e),".}"))}})),q(B(n),"onPartDigestError",(function(e,t){if(n.consoleLog("Error computing digest for part ".concat(JSON.stringify(t),": ").concat(JSON.stringify(e))),"NotFoundError"!==e.name&&"NOT_FOUND_ERR"!==e.name){if(!n.failSessionIfFileChangeDetected())if(t.numDigestRetriesPerformed>=n.config.retries)n.sessionErrorHandler(null,"part_digest_retries_exceeded",JSON.stringify(e));else{var r=Object(s.getBoundedExpBackoffRetryDelay)(n.config.initialRetryDelayMs,n.config.maxRetryDelayMs,t.numDigestRetriesPerformed);t.numDigestRetriesPerformed+=1,n.consoleLog("Retrying digest work for part ".concat(JSON.stringify(t)," in ").concat(r," ms")),setTimeout((function(){n.computeDigestForPart(t)}),r)}}else n.sessionErrorHandler(null,"file_reader_received_not_found_error",JSON.stringify(e))})),q(B(n),"commitSession",(function(){if(!n.isDestroyed()){var e={totalPartReadTime:0,totalPartDigestTime:0,totalFileDigestTime:0,totalPartUploadTime:0},t={parts:n.parts.map((function(t){return e.totalPartReadTime+=t.timing.readTime,e.totalPartDigestTime+=t.timing.subtleCryptoTime,e.totalFileDigestTime+=t.timing.fileDigestTime,e.totalPartUploadTime+=t.timing.uploadTime,t.getPart()})).sort((function(e,t){return e.offset-t.offset})),attributes:{}},r=Object(s.getFileLastModifiedAsISONoMSIfPossible)(n.file);r&&(t.attributes.content_modified_at=r),n.fileDescription&&(t.attributes.description=n.fileDescription);var o={avg_part_read_time:Math.round(e.totalPartReadTime/n.parts.length),avg_part_digest_time:Math.round(e.totalPartDigestTime/n.parts.length),avg_file_digest_time:Math.round(e.totalFileDigestTime/n.parts.length),avg_part_upload_time:Math.round(e.totalPartUploadTime/n.parts.length)},i=n.fileSha1,a={Digest:"sha=".concat(i),"X-Box-Client-Event-Info":JSON.stringify(o)};n.xhr.post({url:n.sessionEndpoints.commit,data:t,headers:a}).then(n.commitSessionSuccessHandler).catch(n.commitSessionErrorHandler)}})),q(B(n),"commitSessionSuccessHandler",(function(e){if(!n.isDestroyed()){var t=e.status,r=e.data;if(202!==t){var o=r.entries;!o&&r.id&&(o=[r]),n.destroy(),n.successCallback&&o&&n.successCallback(o)}else n.commitSessionRetry(e)}})),q(B(n),"commitSessionErrorHandler",(function(e){if(!n.isDestroyed()){var t=e.response;if(t)return n.commitRetryCount>=n.config.retries?(n.consoleLog("Too many commit failures, failing upload"),void n.sessionErrorHandler(e,"commit_retries_exceeded",JSON.stringify(e))):void n.commitSessionRetry(t);n.consoleError(e)}})),q(B(n),"getNumPartsUploading",(function(){return n.numPartsUploading})),n.parts=[],n.options=e,n.fileSha1=null,n.totalUploadedBytes=0,n.numPartsNotStarted=0,n.numPartsDigestComputing=0,n.numPartsDigestReady=0,n.numPartsUploading=0,n.numPartsUploaded=0,n.firstUnuploadedPartIndex=0,n.createSessionNumRetriesPerformed=0,n.partSize=0,n.commitRetryCount=0,n.clientId=null,n.isResumableUploadsEnabled=!1,n.numResumeRetries=0,n}var r,n,i,l,h,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(t,e),r=t,(n=[{key:"reset",value:function(){this.parts=[],this.fileSha1=null,this.totalUploadedBytes=0,this.numPartsNotStarted=0,this.numPartsDigestComputing=0,this.numPartsDigestReady=0,this.numPartsUploading=0,this.numPartsUploaded=0,this.firstUnuploadedPartIndex=0,this.createSessionNumRetriesPerformed=0,this.partSize=0,this.commitRetryCount=0,this.numResumeRetries=0}},{key:"setFileInfo",value:function(e){var t=e.file,r=e.folderId,n=e.errorCallback,i=e.progressCallback,a=e.successCallback,s=e.overwrite,c=void 0===s||s,u=e.conflictCallback,l=e.fileId;this.file=t,this.fileName=this.file.name,this.folderId=r,this.errorCallback=n||o.a,this.progressCallback=i||o.a,this.successCallback=a||o.a,this.overwrite=c,this.conflictCallback=u,this.fileId=l}},{key:"upload",value:function(e){var t=e.file,r=e.fileDescription,n=e.folderId,i=e.errorCallback,a=e.progressCallback,c=e.successCallback,u=e.overwrite,l=void 0===u||u,p=e.conflictCallback,h=e.fileId;this.file=t,this.fileName=this.file.name,this.initialFileSize=this.file.size,this.initialFileLastModified=Object(s.getFileLastModifiedAsISONoMSIfPossible)(this.file),this.folderId=n,this.errorCallback=i||o.a,this.progressCallback=a||o.a,this.successCallback=c||o.a,this.sha1Worker=f(),this.sha1Worker.addEventListener("message",this.onWorkerMessage),this.conflictCallback=p,this.overwrite=l,this.fileId=h,this.fileDescription=r,this.makePreflightRequest()}},{key:"createSessionRetry",value:function(){var e=Object(s.getBoundedExpBackoffRetryDelay)(this.config.initialRetryDelayMs,this.config.maxRetryDelayMs,this.createSessionNumRetriesPerformed);this.createSessionNumRetriesPerformed+=1,this.consoleLog("Retrying create session in ".concat(e," ms")),this.createSessionTimeout=setTimeout(this.makePreflightRequest,e)}},{key:"createSessionSuccessHandler",value:function(e){if(!this.isDestroyed()){var t=e.id,r=e.part_size,n=e.session_endpoints;this.sessionId=t,this.partSize=r,this.sessionEndpoints=F({},this.sessionEndpoints,{uploadPart:n.upload_part,listParts:n.list_parts,commit:n.commit,abort:n.abort,logEvent:n.log_event}),this.populateParts(),this.processNextParts()}}},{key:"resume",value:function(e){var t=e.file,r=e.folderId,n=e.errorCallback,o=e.progressCallback,i=e.sessionId,a=e.successCallback,s=e.overwrite,c=void 0===s||s,u=e.conflictCallback,l=e.fileId;this.setFileInfo({file:t,folderId:r,errorCallback:n,progressCallback:o,successCallback:a,conflictCallback:u,overwrite:c,fileId:l}),this.sessionId=i,this.sha1Worker||(this.sha1Worker=f()),this.sha1Worker.addEventListener("message",this.onWorkerMessage),this.getSessionInfo()}},{key:"getSessionSuccessHandler",value:function(e){var t=e.part_size,r=e.session_endpoints;this.partSize=t,this.sessionEndpoints=F({},this.sessionEndpoints,{uploadPart:r.upload_part,listParts:r.list_parts,commit:r.commit,abort:r.abort,logEvent:r.log_event}),this.processNextParts()}},{key:"getSessionErrorHandler",value:function(e){if(!this.isDestroyed()){var t=this.getErrorResponse(e);if(this.numResumeRetries>this.config.retries)this.errorCallback(t);else if(t&&429===t.status){var r=p.DEFAULT_RETRY_DELAY_MS;if(t.headers){var n=parseInt(t.headers["retry-after"]||t.headers.get("Retry-After"),10);a()(n)||(r=n*p.MS_IN_S)}this.retryTimeout=setTimeout(this.getSessionInfo,r),this.numResumeRetries+=1}else if(t&&t.status>=400&&t.status<500){this.parts.forEach((function(e){e.cancel()})),this.reset(),clearTimeout(this.createSessionTimeout),clearTimeout(this.commitSessionTimeout),this.abortSession();var o={file:this.file,folderId:this.folderId,errorCallback:this.errorCallback,progressCallback:this.progressCallback,successCallback:this.successCallback,overwrite:this.overwrite,fileId:this.fileId};this.upload(o)}else this.retryTimeout=setTimeout(this.getSessionInfo,Math.pow(2,this.numResumeRetries)*p.MS_IN_S),this.numResumeRetries+=1}}},{key:"sessionErrorHandler",value:(d=H(regeneratorRuntime.mark((function e(t,r,n){var o,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isResumableUploadsEnabled||this.destroy(),o=this.getErrorResponse(t),this.errorCallback(o),e.prev=3,this.sessionEndpoints.logEvent){e.next=6;break}throw new Error("logEvent endpoint not found");case 6:return e.next=8,Object(c.a)((function(e,t){i.logEvent(r,n).then(e).catch(t)}),this.config.retries,this.config.initialRetryDelayMs);case 8:this.isResumableUploadsEnabled||this.abortSession(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),this.isResumableUploadsEnabled||this.abortSession();case 14:case"end":return e.stop()}}),e,this,[[3,11]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"abortSession",value:function(){var e=this;this.sha1Worker&&this.sha1Worker.terminate(),this.sessionEndpoints.abort&&this.sessionId&&this.xhr.delete({url:this.sessionEndpoints.abort}).then((function(){e.sessionId=""}))}},{key:"shouldComputeDigestForNextPart",value:function(){return!this.isDestroyed()&&0===this.numPartsDigestComputing&&this.numPartsNotStarted>0&&this.numPartsDigestReady<this.config.digestReadahead}},{key:"computeDigestForNextPart",value:function(){for(var e=this.firstUnuploadedPartIndex;e<this.parts.length;e+=1){var t=this.parts[e];if(0===t.state)return this.numPartsNotStarted-=1,this.numPartsDigestComputing+=1,void this.computeDigestForPart(t)}}},{key:"computeDigestForPart",value:(h=H(regeneratorRuntime.mark((function e(t){var r,n,o,i,a,s,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.file.slice(t.offset,t.offset+this.partSize),n=new window.FileReader,o=Date.now(),e.prev=3,e.next=6,this.readFile(n,r);case 6:return i=e.sent,a=i.buffer,s=i.readCompleteTimestamp,e.next=11,Object(u.a)("SHA-256",a);case 11:c=e.sent,l=btoa([].reduce.call(new Uint8Array(c),(function(e,t){return e+String.fromCharCode(t)}),"")),this.sendPartToWorker(t,a),t.sha256=l,t.state=1,t.blob=r,this.numPartsDigestReady+=1,f=Date.now(),t.timing={partDigestTime:f-o,readTime:s-o,subtleCryptoTime:f-s},this.processNextParts(),e.next=26;break;case 23:e.prev=23,e.t0=e.catch(3),this.onPartDigestError(e.t0,t);case 26:case"end":return e.stop()}}),e,this,[[3,23]])}))),function(e){return h.apply(this,arguments)})},{key:"commitSessionRetry",value:function(e){var t=e.status,r=e.headers,n=p.DEFAULT_RETRY_DELAY_MS;if(r){var o=parseInt(r["retry-after"],10);Number.isNaN(o)||(n=1e3*o)}var i=Object(s.getBoundedExpBackoffRetryDelay)(this.config.initialRetryDelayMs,this.config.maxRetryDelayMs,this.commitRetryCount);202!==t&&(this.commitRetryCount+=1);var a=n||i;this.consoleLog("Retrying commit in ".concat(a," ms")),this.commitSessionTimeout=setTimeout(this.commitSession,a)}},{key:"uploadNextPart",value:function(){for(var e=this.firstUnuploadedPartIndex;e<this.parts.length;e+=1){var t=this.parts[e];if(1===t.state){this.numPartsDigestReady-=1,this.numPartsUploading+=1,t.isPaused?t.unpause():t.upload();break}}}},{key:"canStartMorePartUploads",value:function(){return!this.isDestroyed()&&this.numPartsUploading<this.config.parallelism&&this.numPartsDigestReady>0}},{key:"updateFirstUnuploadedPartIndex",value:function(){for(var e=this.parts[this.firstUnuploadedPartIndex];e&&3===e.state;)this.firstUnuploadedPartIndex+=1,e=this.parts[this.firstUnuploadedPartIndex]}},{key:"populateParts",value:function(){this.numPartsNotStarted=Math.ceil(this.file.size/this.partSize);for(var e=0;e<this.numPartsNotStarted;e+=1){var t=e*this.partSize,r=Math.min(t+this.partSize,this.file.size)-t,n=new j(this.options,e,t,r,this.file.size,this.sessionId,this.sessionEndpoints,this.config,this.getNumPartsUploading,this.partUploadSuccessHandler,this.updateProgress,this.partUploadErrorHandler);this.parts.push(n)}}},{key:"failSessionIfFileChangeDetected",value:function(){var e=this.file.size,t=Object(s.getFileLastModifiedAsISONoMSIfPossible)(this.file);return(e!==this.initialFileSize||t!==this.initialFileLastModified)&&(this.sessionErrorHandler(null,"file_changed_during_upload",JSON.stringify({oldSize:this.initialFileSize,newSize:e,oldLastModified:this.initialFileLastModified,newLastModified:t})),!0)}},{key:"cancel",value:function(){this.isDestroyed()||(this.parts.forEach((function(e){e.cancel()})),this.parts=[],clearTimeout(this.createSessionTimeout),clearTimeout(this.commitSessionTimeout),this.abortSession(),this.destroy())}},{key:"resolveConflict",value:(l=H(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.overwrite||!t.context_info){e.next=3;break}return this.fileId=t.context_info.conflicts.id,e.abrupt("return");case 3:if(!this.conflictCallback){e.next=6;break}return this.fileName=this.conflictCallback(this.fileName),e.abrupt("return");case 6:r=this.fileName.substr(this.fileName.lastIndexOf("."))||"",this.fileName="".concat(this.fileName.substr(0,this.fileName.lastIndexOf(".")),"-").concat(Date.now()).concat(r);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"getErrorResponse",value:function(e){if(!e)return{};var t=e.response;return t?401===t.status?t:t.data:{}}}])&&M(r.prototype,n),i&&M(r,i),t}(C);t.a=K},"Jdck50bD+l":function(e,t,r){"use strict";r.r(t);var n=r("AkPpBUyl/w");r.d(t,"default",(function(){return n.a}))},JmpYOFvNxD:function(e,t,r){var n=r("eUghvDZG6g");e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},OFL0i0gLuj:function(e,t,r){var n=r("lvO4QcjowG"),o=r("4sDhcbmZ70");e.exports=function(e,t){return null!=e&&o(e,t,n)}},"P/G1/AIOfM":function(e,t,r){var n=r("JmpYOFvNxD"),o=r("7GkXteOAfp");e.exports=function(e){return null==e?[]:n(e,o(e))}},"PDX0CS6jv/":function(e,t){(function(t){e.exports=t}).call(this,{})},PRoclJX2va:function(e,t,r){"use strict";var n=r("fn3w3TIrL6"),o=r("8Wpvjplx0g");t.a=function(e,t,r,i){var a=[];return e.forEach((function(e){var s,c=e.id,u=e.type;if(!c||!u)throw Object(n.a)();switch(u){case o.TYPE_FOLDER:s=t;break;case o.TYPE_FILE:s=r;break;case o.TYPE_WEBLINK:s=i;break;default:throw new Error("Unknown Type!")}var l=s.getCache(),f=s.getCacheKey(c);l.has(f)?l.merge(f,e):l.set(f,e),a.push(f)})),a}},"VqrN+CpLF1":function(e,t,r){"use strict";var n=r("vN+2IcUykn"),o=r.n(n),i=r("PRoclJX2va"),a=r("7EA+m7Wkjh"),s=r("fn3w3TIrL6"),c=r("k1oiGGP5HG"),u=r("dEgP6Cehtk"),l=r("5mCW88DpfN"),f=r("8Wpvjplx0g");function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t){return!t||"object"!==p(t)&&"function"!==typeof t?g(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O=function(e){function t(){var e,r;y(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return E(g(r=m(this,(e=v(t)).call.apply(e,[this].concat(o)))),"folderSuccessHandler",(function(e){var n=e.data;if(!r.isDestroyed()){var o=n.item_collection;if(!o)throw Object(s.a)();var a=o.entries,c=o.total_count,f=o.limit,p=o.offset;if(!Array.isArray(a)||"number"!==typeof c||"number"!==typeof f||"number"!==typeof p)throw Object(s.a)();var h=Object(i.a)(a,new t(r.options),new u.a(r.options),new l.a(r.options));r.itemCache=(r.itemCache||[]).concat(h),r.getCache().set(r.key,d({},n,{item_collection:d({},o,{entries:r.itemCache})})),r.finish()}})),E(g(r),"folderDetailsSuccessHandler",(function(e){var t=e.data;if(!r.isDestroyed()){var n=d({},r.getCache().get(r.key),{},t);r.getCache().set(r.key,n),r.successCallback(n)}})),E(g(r),"createSuccessHandler",(function(e){var t=e.data,n=t.id;if(!r.isDestroyed()&&n){var o=r.getCacheKey(n),i=r.getCache(),a=i.get(r.key);if(a){var c=a.item_collection;if(!c)throw Object(s.a)();var u=c.total_count,l=c.entries;if(!Array.isArray(l)||"number"!==typeof u)throw Object(s.a)();i.set(o,t),c.entries=[o].concat(l),c.total_count=u+1,r.successCallback(t)}else r.successCallback(t)}})),r}var r,n,c;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,e),r=t,(n=[{key:"getCacheKey",value:function(e){return"".concat(f.CACHE_PREFIX_FOLDER).concat(e)}},{key:"getUrl",value:function(e){var t=e?"/".concat(e):"";return"".concat(this.getBaseApiUrl(),"/folders").concat(t)}},{key:"isLoaded",value:function(){return this.getCache().has(this.key)}},{key:"finish",value:function(){if(!this.isDestroyed()){var e=this.getCache(),t=e.get(this.key),r=t.id,n=t.name,o=t.permissions,i=t.path_collection,a=t.item_collection;if(!a||!i)throw Object(s.a)();var c=a.entries,u=a.offset,l=a.total_count;if(!Array.isArray(c)||"number"!==typeof l)throw Object(s.a)();var f={id:r,name:n,offset:u,percentLoaded:100,permissions:o,boxItem:t,breadcrumbs:i.entries,items:c.map((function(t){return e.get(t)})),sortBy:this.sortBy,sortDirection:this.sortDirection,totalCount:l};this.successCallback(f)}}},{key:"folderRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fields,r=e.noPagination,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.folderSuccessHandler;if(this.isDestroyed())return Promise.reject();var o=t||a.e;this.errorCode=f.ERROR_CODE_FETCH_FOLDER;var i={fields:o.toString()};return r||(i=d({},i,{direction:this.sortDirection.toLowerCase(),limit:this.limit,offset:this.offset,fields:o.toString(),sort:this.sortBy.toLowerCase()})),this.xhr.get({url:this.getUrl(this.id),params:i,headers:o.includes(f.FIELD_REPRESENTATIONS)?{"X-Rep-Hints":f.X_REP_HINT_HEADER_DIMENSIONS_DEFAULT}:{}}).then(n).catch(this.errorHandler)}},{key:"getFolderFields",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.isDestroyed()||(this.id=e,this.key=this.getCacheKey(e),this.successCallback=t,this.errorCallback=r,this.folderRequest(d({},n,{noPagination:!0}),this.folderDetailsSuccessHandler))}},{key:"getFolder",value:function(e,t,r,n,o,i,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};this.isDestroyed()||(this.id=e,this.key=this.getCacheKey(e),this.limit=t,this.offset=r,this.sortBy=n,this.sortDirection=o,this.successCallback=i,this.errorCallback=a,s.forceFetch&&this.getCache().unset(this.key),this.isLoaded()?this.finish():this.folderRequest(s))}},{key:"folderCreateRequest",value:function(e){if(this.isDestroyed())return Promise.reject();this.errorCode=f.ERROR_CODE_CREATE_FOLDER;var t="".concat(this.getUrl(),"?fields=").concat(a.e.toString());return this.xhr.post({url:t,data:{name:e,parent:{id:this.id}}}).then(this.createSuccessHandler).catch(this.errorHandler)}},{key:"create",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.a;this.isDestroyed()||(this.id=e,this.key=this.getCacheKey(e),this.successCallback=r,this.errorCallback=n,this.folderCreateRequest(t))}}])&&b(r.prototype,n),c&&b(r,c),t}(c.a);t.a=O},"YZm+6poGny":function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";var root="object"===typeof window?window:{},NODE_JS=!root.JS_SHA1_NO_NODE_JS&&"object"===typeof process&&process.versions&&process.versions.node;NODE_JS&&(root=global);var COMMON_JS=!root.JS_SHA1_NO_COMMON_JS&&"object"===typeof module&&module.exports,AMD=__webpack_require__("PDX0CS6jv/"),HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=function(e){return function(t){return new Sha1(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Sha1},e.update=function(t){return e.create().update(t)};for(var t=0;t<OUTPUT_TYPES.length;++t){var r=OUTPUT_TYPES[t];e[r]=createOutputMethod(r)}return e},nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"===typeof e)return crypto.createHash("sha1").update(e,"utf8").digest("hex");if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(void 0===e.length)return method(e);return crypto.createHash("sha1").update(new Buffer(e)).digest("hex")};return nodeMethod};function Sha1(e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(e){if(!this.finalized){var t="string"!==typeof e;t&&e.constructor===root.ArrayBuffer&&(e=new Uint8Array(e));for(var r,n,o=0,i=e.length||0,a=this.blocks;o<i;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)for(n=this.start;o<i&&n<64;++o)a[n>>2]|=e[o]<<SHIFT[3&n++];else for(n=this.start;o<i&&n<64;++o)(r=e.charCodeAt(o))<128?a[n>>2]|=r<<SHIFT[3&n++]:r<2048?(a[n>>2]|=(192|r>>6)<<SHIFT[3&n++],a[n>>2]|=(128|63&r)<<SHIFT[3&n++]):r<55296||r>=57344?(a[n>>2]|=(224|r>>12)<<SHIFT[3&n++],a[n>>2]|=(128|r>>6&63)<<SHIFT[3&n++],a[n>>2]|=(128|63&r)<<SHIFT[3&n++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++o)),a[n>>2]|=(240|r>>18)<<SHIFT[3&n++],a[n>>2]|=(128|r>>12&63)<<SHIFT[3&n++],a[n>>2]|=(128|r>>6&63)<<SHIFT[3&n++],a[n>>2]|=(128|63&r)<<SHIFT[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=a[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha1.prototype.hash=function(){var e,t,r=this.h0,n=this.h1,o=this.h2,i=this.h3,a=this.h4,s=this.blocks;for(e=16;e<80;++e)t=s[e-3]^s[e-8]^s[e-14]^s[e-16],s[e]=t<<1|t>>>31;for(e=0;e<20;e+=5)r=(t=(n=(t=(o=(t=(i=(t=(a=(t=r<<5|r>>>27)+(n&o|~n&i)+a+1518500249+s[e]<<0)<<5|a>>>27)+(r&(n=n<<30|n>>>2)|~r&o)+i+1518500249+s[e+1]<<0)<<5|i>>>27)+(a&(r=r<<30|r>>>2)|~a&n)+o+1518500249+s[e+2]<<0)<<5|o>>>27)+(i&(a=a<<30|a>>>2)|~i&r)+n+1518500249+s[e+3]<<0)<<5|n>>>27)+(o&(i=i<<30|i>>>2)|~o&a)+r+1518500249+s[e+4]<<0,o=o<<30|o>>>2;for(;e<40;e+=5)r=(t=(n=(t=(o=(t=(i=(t=(a=(t=r<<5|r>>>27)+(n^o^i)+a+1859775393+s[e]<<0)<<5|a>>>27)+(r^(n=n<<30|n>>>2)^o)+i+1859775393+s[e+1]<<0)<<5|i>>>27)+(a^(r=r<<30|r>>>2)^n)+o+1859775393+s[e+2]<<0)<<5|o>>>27)+(i^(a=a<<30|a>>>2)^r)+n+1859775393+s[e+3]<<0)<<5|n>>>27)+(o^(i=i<<30|i>>>2)^a)+r+1859775393+s[e+4]<<0,o=o<<30|o>>>2;for(;e<60;e+=5)r=(t=(n=(t=(o=(t=(i=(t=(a=(t=r<<5|r>>>27)+(n&o|n&i|o&i)+a-1894007588+s[e]<<0)<<5|a>>>27)+(r&(n=n<<30|n>>>2)|r&o|n&o)+i-1894007588+s[e+1]<<0)<<5|i>>>27)+(a&(r=r<<30|r>>>2)|a&n|r&n)+o-1894007588+s[e+2]<<0)<<5|o>>>27)+(i&(a=a<<30|a>>>2)|i&r|a&r)+n-1894007588+s[e+3]<<0)<<5|n>>>27)+(o&(i=i<<30|i>>>2)|o&a|i&a)+r-1894007588+s[e+4]<<0,o=o<<30|o>>>2;for(;e<80;e+=5)r=(t=(n=(t=(o=(t=(i=(t=(a=(t=r<<5|r>>>27)+(n^o^i)+a-899497514+s[e]<<0)<<5|a>>>27)+(r^(n=n<<30|n>>>2)^o)+i-899497514+s[e+1]<<0)<<5|i>>>27)+(a^(r=r<<30|r>>>2)^n)+o-899497514+s[e+2]<<0)<<5|o>>>27)+(i^(a=a<<30|a>>>2)^r)+n-899497514+s[e+3]<<0)<<5|n>>>27)+(o^(i=i<<30|i>>>2)^a)+r-899497514+s[e+4]<<0,o=o<<30|o>>>2;this.h0=this.h0+r<<0,this.h1=this.h1+n<<0,this.h2=this.h2+o<<0,this.h3=this.h3+i<<0,this.h4=this.h4+a<<0},Sha1.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4;return HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]},Sha1.prototype.toString=Sha1.prototype.hex,Sha1.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,o=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,o>>24&255,o>>16&255,o>>8&255,255&o]},Sha1.prototype.array=Sha1.prototype.digest,Sha1.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};var exports=createMethod();COMMON_JS?module.exports=exports:(root.sha1=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__("8oxByP8VSs"),__webpack_require__("yLpjYHveuD"))},"YrhTq/oyJV":function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_API_OPTIONS",(function(){return s})),r.d(t,"doesDataTransferItemContainAPIOptions",(function(){return u})),r.d(t,"doesFileContainAPIOptions",(function(){return c})),r.d(t,"getBoundedExpBackoffRetryDelay",(function(){return m})),r.d(t,"getDataTransferItem",(function(){return f})),r.d(t,"getDataTransferItemAPIOptions",(function(){return h})),r.d(t,"getDataTransferItemId",(function(){return C})),r.d(t,"getEntryFromDataTransferItem",(function(){return v})),r.d(t,"getFile",(function(){return l})),r.d(t,"getFileAPIOptions",(function(){return p})),r.d(t,"getFileFromDataTransferItem",(function(){return E})),r.d(t,"getFileFromEntry",(function(){return _})),r.d(t,"getFileId",(function(){return k})),r.d(t,"getFileLastModifiedAsISONoMSIfPossible",(function(){return y})),r.d(t,"isDataTransferItemAFolder",(function(){return g})),r.d(t,"isMultiputSupported",(function(){return P})),r.d(t,"toISOStringNoMS",(function(){return d})),r.d(t,"tryParseJson",(function(){return b}));var n=r("mwIZSSbMl2"),o=r.n(n);function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}var s={};function c(e){return!(!e.options||!e.file)}function u(e){return!(!e.options||!e.item)}function l(e){return c(e)?e.file:e}function f(e){return u(e)?e.item:e}function p(e){return c(e)&&e.options||s}function h(e){return u(e)&&e.options||s}function d(e){return e.toISOString().replace(/\.[0-9]{3}/,"")}function y(e){var t,r=e.lastModified||e.lastModifiedDate;if(r&&("string"===typeof r||"number"===typeof r||r instanceof Date)){var n=new Date(r);if(t=n,"[object Date]"===Object.prototype.toString.call(t)&&!Number.isNaN(t.getTime()))return d(n)}return null}function b(e){try{return JSON.parse(e)}catch(e){return null}}function m(e,t,r){var n=e*Math.pow(r,2);return n>t?t:n}function v(e){return(e.webkitGetAsEntry||e.mozGetAsEntry||e.getAsEntry).call(e)}function g(e){var t=v(f(e));return!!t&&t.isDirectory}function _(e){return new Promise((function(t){e.file((function(e){t(e)}))}))}function E(e){return O.apply(this,arguments)}function O(){return(O=a(regeneratorRuntime.mark((function e(t){var r,n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f(t),n=v(r)){e.next=4;break}return e.abrupt("return",null);case 4:return e.next=6,_(n);case 6:if(o=e.sent,!u(t)){e.next=9;break}return e.abrupt("return",{file:o,options:h(t)});case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e,t){if(!c(e))return e.name;var r=e,n=o()(r,"options.folderId",t),i=o()(r,"options.uploadInitTimestamp",Date.now()),a=r.file.webkitRelativePath||r.file.name;return"".concat(a,"_").concat(n,"_").concat(i)}function C(e,t){var r=v(f(e)).name,n=h(e),o=n.folderId,i=void 0===o?t:o,a=n.uploadInitTimestamp,s=void 0===a?Date.now():a;return"".concat(r,"_").concat(i,"_").concat(s)}function P(){var e=window.crypto||window.msCrypto;return"https:"===window.location.protocol&&e&&e.subtle}},"aAZChApN2+":function(e,t,r){var n=r("sgoqXtgn3Q")((function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}));e.exports=n},dEgP6Cehtk:function(e,t,r){"use strict";var n=r("cr+IVGIN9M"),o=r.n(n),i=r("mwIZSSbMl2"),a=r.n(i),s=r("7EA+m7Wkjh"),c=r("a2jX1cNsCJ"),u=r("fn3w3TIrL6"),l=r("8Wpvjplx0g"),f=r("k1oiGGP5HG"),p=r("BweDcK5eOp"),h=r("vVaM4hVnXJ");function d(e){return(d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function g(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){v(i,n,o,a,s,"next",e)}function s(e){v(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return!t||"object"!==d(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var P=function(e){function t(){return _(this,t),O(this,k(t).apply(this,arguments))}var r,n,i,f,d,y,m;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(t,e),r=t,(n=[{key:"getCacheKey",value:function(e){return"".concat(l.CACHE_PREFIX_FILE).concat(e)}},{key:"getUrl",value:function(e){var t=e?"/".concat(e):"";return"".concat(this.getBaseApiUrl(),"/files").concat(t)}},{key:"getDownloadUrl",value:(m=g(regeneratorRuntime.mark((function e(t,r,n,i){var a,s,u,f,p,d,y,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.errorCode=l.ERROR_CODE_GET_DOWNLOAD_URL,this.errorCallback=i,this.successCallback=n,a=r[l.FIELD_IS_DOWNLOAD_AVAILABLE],s=r[l.FIELD_AUTHENTICATED_DOWNLOAD_URL],e.next=7,h.a.getReadToken(Object(c.getTypedFileId)(t),this.options.token);case 7:if(u=e.sent,a&&s&&u){e.next=11;break}return this.errorHandler(new Error("Download is missing required fields or token.")),e.abrupt("return");case 11:f=o.a.parseUrl(s),p=f.query,d=f.url,y=b({},p,{access_token:u}),m=o.a.stringify(y),this.successHandler("".concat(d,"?").concat(m));case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return m.apply(this,arguments)})},{key:"isRepresentationsCallComplete",value:function(e){var t=a()(e,"data.status.state");return!t||t===l.REPRESENTATIONS_RESPONSE_ERROR||t===l.REPRESENTATIONS_RESPONSE_SUCCESS||t===l.REPRESENTATIONS_RESPONSE_VIEWABLE}},{key:"generateRepresentation",value:(y=g(regeneratorRuntime.mark((function e(t){var r,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a()(t,"info.url")){e.next=3;break}return e.abrupt("return",t);case 3:return e.abrupt("return",Object(p.a)((function(e,t){return n.xhr.get({successCallback:e,errorCallback:t,url:r}).then((function(r){return n.isRepresentationsCallComplete(r)?e(r.data):t(r.data)})).catch((function(e){t(e)}))}),4,2e3,2));case 4:case"end":return e.stop()}}),e)}))),function(e){return y.apply(this,arguments)})},{key:"getThumbnailUrl",value:(d=g(regeneratorRuntime.mark((function e(t){var r,n,i,s,u,l,f,p,d,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a()(t,"representations.entries[0]"),n=a()(r,"representation"),i=a()(r,"content.url_template"),e.next=5,h.a.getReadToken(Object(c.getTypedFileId)(t.id),this.options.token);case 5:if(s=e.sent,n&&i&&s){e.next=8;break}return e.abrupt("return",null);case 8:return u=i.replace("{+asset_path}","jpg"===n?"":"1.png"),l=o.a.parseUrl(u),f=l.query,p=l.url,d=b({},f,{access_token:s}),y=o.a.stringify(d),e.abrupt("return","".concat(p,"?").concat(y));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"setFileDescription",value:function(e,t,r,n){var o=this,i=e.id,a=e.permissions;return i&&a?a.can_rename?this.xhr.put({id:Object(c.getTypedFileId)(i),url:this.getUrl(i),data:{description:t}}).then((function(e){var t=e.data;if(!o.isDestroyed()){var n=o.merge(o.getCacheKey(i),"description",t.description);r(n)}})).catch((function(){if(!o.isDestroyed()){var t=o.merge(o.getCacheKey(i),"description",e.description);n(t)}})):(n(Object(u.b)()),Promise.reject()):(n(Object(u.a)()),Promise.reject())}},{key:"getFile",value:(f=g(regeneratorRuntime.mark((function e(t,r,n){var o,i,a,u,f,p,h,d,y,b,m=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=m.length>3&&void 0!==m[3]?m[3]:{},!this.isDestroyed()){e.next=3;break}return e.abrupt("return");case 3:if(i=this.getCache(),a=this.getCacheKey(t),u=!o.forceFetch&&i.has(a),f=u?i.get(a):{id:t},p=Object(s.i)(f,o.fields),h={id:Object(c.getTypedFileId)(t),url:this.getUrl(t),headers:{"X-Rep-Hints":l.X_REP_HINTS}},this.errorCode=l.ERROR_CODE_FETCH_FILE,this.successCallback=r,this.errorCallback=n,!u||0!==p.length){e.next=17;break}if(r(f),p=o.fields||[],o.refreshCache){e.next=17;break}return e.abrupt("return");case 17:return p.length>0&&(h.params={fields:p.toString()}),e.prev=18,e.next=21,this.xhr.get(h);case 21:if(d=e.sent,y=d.data,!this.isDestroyed()){e.next=25;break}return e.abrupt("return");case 25:b=Object(s.h)(y,p),i.has(a)?i.merge(a,b):i.set(a,b),this.successHandler(i.get(a)),e.next=33;break;case 30:e.prev=30,e.t0=e.catch(18),this.errorHandler(e.t0);case 33:case"end":return e.stop()}}),e,this,[[18,30]])}))),function(e,t,r){return f.apply(this,arguments)})},{key:"getFileExtension",value:function(e,t,r){this.isDestroyed()||this.getFile(e,t,r,{fields:[l.FIELD_EXTENSION]})}}])&&E(r.prototype,n),i&&E(r,i),t}(f.a);t.a=P},fh8xsLuPZu:function(e,t,r){"use strict";var n=r("3iqZJKdelp"),o=r("8Wpvjplx0g");function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(e){function t(){var e,r;a(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return p(l(r=c(this,(e=u(t)).call.apply(e,[this].concat(i)))),"retryCount",0),p(l(r),"makePreflightRequest",(function(){if(!r.isDestroyed()){var e="".concat(r.getBaseApiUrl(),"/files/content");r.fileId&&(e=e.replace("content","".concat(r.fileId,"/content")));var t=r.file,n=t.size,o=t.name,i={name:r.fileName||o,parent:{id:r.folderId},description:r.fileDescription,size:n};r.xhr.options({url:e,data:i,successHandler:r.preflightSuccessHandler,errorHandler:r.preflightErrorHandler})}})),p(l(r),"preflightErrorHandler",(function(e){if(!r.isDestroyed()){r.fileName=r.file?r.file.name:"";var t=e,n=e.response;if(n&&n.data&&(t=n.data),r.retryCount>=5)r.errorCallback(t);else if(t&&409===t.status){if(r.overwrite){var i=t.context_info.conflicts.id;!r.fileId&&i&&(r.fileId=i)}else if(r.conflictCallback)r.fileName=r.conflictCallback(r.fileName);else{var a=r.fileName.substr(r.fileName.lastIndexOf("."))||"";r.fileName="".concat(r.fileName.substr(0,r.fileName.lastIndexOf(".")),"-").concat(Date.now()).concat(a)}r.makePreflightRequest(),r.retryCount+=1}else if(!t||429!==t.status&&"too_many_requests"!==t.code)t&&(t.status||"Failed to fetch"===t.message)&&"function"===typeof r.errorCallback?r.errorCallback(t):(r.retryTimeout=setTimeout(r.makePreflightRequest,Math.pow(2,r.retryCount)*o.MS_IN_S),r.retryCount+=1);else{var s=o.DEFAULT_RETRY_DELAY_MS;if(t.headers){var c=parseInt(t.headers["retry-after"]||t.headers.get("Retry-After"),10);Number.isNaN(c)||(s=c*o.MS_IN_S)}r.retryTimeout=setTimeout(r.makePreflightRequest,s),r.retryCount+=1}}})),r}var r,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),r=t,(n=[{key:"readFile",value:function(e,t){return new Promise((function(r,n){e.readAsArrayBuffer(t),e.onload=function(){r({buffer:e.result,readCompleteTimestamp:Date.now()})},e.onerror=n}))}}])&&s(r.prototype,n),i&&s(r,i),t}(n.a);t.a=h},fn3w3TIrL6:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return s}));var n=r("8Wpvjplx0g");function o(){return new Error("Bad box item!")}function i(){return new Error("Insufficient Permissions!")}function a(){return new Error("Bad box user!")}function s(e){return e===n.HTTP_STATUS_CODE_RATE_LIMIT||e===n.HTTP_STATUS_CODE_UNAUTHORIZED||e===n.HTTP_STATUS_CODE_CONFLICT||e>=n.HTTP_STATUS_CODE_INTERNAL_SERVER_ERROR}},ijCdHo2SAB:function(e,t,r){var n=r("R/W3CmeeGC"),o=r("MMmD7nEs5h"),i=r("4qC0uLa34A"),a=r("Sxd8nJhe7E"),s=r("P/G1/AIOfM"),c=Math.max;e.exports=function(e,t,r,u){e=o(e)?e:s(e),r=r&&!u?a(r):0;var l=e.length;return r<0&&(r=c(l+r,0)),i(e)?r<=l&&e.indexOf(t,r)>-1:!!l&&n(e,t,r)>-1}},k1oiGGP5HG:function(e,t,r){"use strict";var n=r("vN+2IcUykn"),o=r.n(n),i=r("D1y2Gn20OY"),a=r.n(i),s=r("fn3w3TIrL6"),c=r("3iqZJKdelp"),u=r("8Wpvjplx0g");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?b(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(e){function t(){var e,r;p(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return v(b(r=d(this,(e=y(t)).call.apply(e,[this].concat(o)))),"deleteSuccessHandler",(function(){if(!r.isDestroyed()){var e=r.getParentCacheKey(r.parentId),t=r.getCache().get(e);if(t){var n=t.item_collection;if(n){var o=n.entries,i=n.total_count;if(!Array.isArray(o)||"number"!==typeof i)throw Object(s.a)();var a=r.getCacheKey(r.id),c=o.length,u=o.filter((function(e){return e!==a})),l=u.length,p=r.merge(e,"item_collection",f(n,{entries:u,total_count:i-(c-l)}));r.successCallback(p),r.postDeleteCleanup()}else r.postDeleteCleanup()}else r.postDeleteCleanup()}})),v(b(r),"renameSuccessHandler",(function(e){var t=e.data;if(!r.isDestroyed()){r.getCache().unsetAll(u.CACHE_PREFIX_SEARCH);var n=r.merge(r.getCacheKey(r.id),"name",t.name);r.successCallback(n)}})),v(b(r),"shareSuccessHandler",(function(e){var t=e.data;if(!r.isDestroyed()){var n=r.merge(r.getCacheKey(r.id),"shared_link",t.shared_link);r.successCallback(n)}})),r}var r,n,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),r=t,(n=[{key:"getParentCacheKey",value:function(e){return"".concat(u.CACHE_PREFIX_FOLDER).concat(e)}},{key:"getCacheKey",value:function(e){return"getCacheKey(".concat(e,") should be overriden")}},{key:"getUrl",value:function(e){return"getUrl(".concat(e,") should be overriden")}},{key:"merge",value:function(e,t,r){var n=this.getCache();return n.merge(e,a()({},t,r)),n.get(e)}},{key:"postDeleteCleanup",value:function(){this.isDestroyed()||(this.getCache().unsetAll(u.CACHE_PREFIX_SEARCH),this.successCallback())}},{key:"deleteItem",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.a;if(this.isDestroyed())return Promise.reject();this.errorCode=u.ERROR_CODE_DELETE_ITEM;var i=e.id,a=e.permissions,c=e.parent,l=e.type;if(!i||!a||!c||!l)return n(Object(s.a)(),this.errorCode),Promise.reject();var f=c.id,p=a.can_delete;if(!p||!f)return n(Object(s.b)(),this.errorCode),Promise.reject();this.id=i,this.parentId=f,this.successCallback=t,this.errorCallback=n;var h="".concat(this.getUrl(i)).concat(l===u.TYPE_FOLDER?"?recursive=true":"");return this.xhr.delete({url:h}).then(this.deleteSuccessHandler).catch((function(e){r.errorHandler(e)}))}},{key:"rename",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.a;if(this.isDestroyed())return Promise.reject();this.errorCode=u.ERROR_CODE_RENAME_ITEM;var a=e.id,c=e.permissions;if(!a||!c)return i(Object(s.a)(),this.errorCode),Promise.reject();var l=c.can_rename;return l?(this.id=a,this.successCallback=r,this.errorCallback=i,this.xhr.put({url:"".concat(this.getUrl(a)),data:{name:t}}).then(this.renameSuccessHandler).catch((function(e){n.errorHandler(e)}))):(i(Object(s.b)(),this.errorCode),Promise.reject())}},{key:"share",value:function(e,t,r){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.a;if(this.isDestroyed())return Promise.reject();this.errorCode=u.ERROR_CODE_SHARE_ITEM;var a=e.id,c=e.permissions;if(!a||!c)return i(Object(s.a)(),this.errorCode),Promise.reject();var l=c.can_share,f=c.can_set_share_access;return l&&f?(this.id=a,this.successCallback=r,this.errorCallback=i,this.xhr.put({url:this.getUrl(this.id),data:{shared_link:t===u.ACCESS_NONE?null:{access:t}}}).then(this.shareSuccessHandler).catch((function(e){n.errorHandler(e)}))):(i(Object(s.b)(),this.errorCode),Promise.reject())}}])&&h(r.prototype,n),i&&h(r,i),t}(c.a);t.a=g},lvO4QcjowG:function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&r.call(e,t)}},vVaM4hVnXJ:function(e,t,r){"use strict";var n=r("8Wpvjplx0g");function o(e){return(o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function s(e){i(a,n,o,s,c,"next",e)}function c(e){i(a,n,o,s,c,"throw",e)}s(void 0)}))}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=new Error("Bad id or auth token. ID should be typed id like file_123 or folder_123! Token should be a string or function."),u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,i,u,l,f,p,h;return t=e,r=null,i=[{key:"getToken",value:(h=a(regeneratorRuntime.mark((function e(t,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===r||void 0===r||"string"===typeof r||"function"===typeof r)&&(t.startsWith(n.TYPED_ID_FOLDER_PREFIX)||t.startsWith(n.TYPED_ID_FILE_PREFIX))){e.next=2;break}throw c;case 2:if(r&&"string"!==typeof r){e.next=4;break}return e.abrupt("return",r);case 4:return e.next=6,r(t);case 6:if((i=e.sent)&&"string"!==typeof i&&("object"!==o(i)||!i.read&&!i.write)){e.next=9;break}return e.abrupt("return",i);case 9:throw c;case 10:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)})},{key:"getReadToken",value:(p=a(regeneratorRuntime.mark((function t(r,n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getToken(r,n);case 2:if(!(i=t.sent)||"object"!==o(i)){t.next=5;break}return t.abrupt("return",i.read);case 5:return t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)}))),function(e,t){return p.apply(this,arguments)})},{key:"getReadTokens",value:(f=a(regeneratorRuntime.mark((function t(r,n){var o,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Array.isArray(r)?r:[r],i=o.map((function(t){return e.getReadToken(t,n)})),t.next=4,Promise.all(i);case 4:return a=t.sent,s={},a.forEach((function(e,t){s[o[t]]=e})),t.abrupt("return",Promise.resolve(s));case 8:case"end":return t.stop()}}),t)}))),function(e,t){return f.apply(this,arguments)})},{key:"getWriteToken",value:(l=a(regeneratorRuntime.mark((function t(r,n){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getToken(r,n);case 2:if(!(i=t.sent)||"object"!==o(i)){t.next=5;break}return t.abrupt("return",i.write||i.read);case 5:return t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)}))),function(e,t){return l.apply(this,arguments)})},{key:"cacheTokens",value:(u=a(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===r||void 0===r||"string"===typeof r||"function"===typeof r)&&t.every((function(e){return e.startsWith(n.TYPED_ID_FOLDER_PREFIX)||e.startsWith(n.TYPED_ID_FILE_PREFIX)}))){e.next=2;break}throw c;case 2:if("function"!==typeof r){e.next=5;break}return e.next=5,r(t);case 5:return e.abrupt("return",Promise.resolve());case 6:case"end":return e.stop()}}),e)}))),function(e,t){return u.apply(this,arguments)})}],r&&s(t.prototype,r),i&&s(t,i),e}();t.a=u},zJHzwnUt45:function(e,t,r){"use strict";var n=r("JRPeW/Ew/U"),o=Object(n.defineMessages)({appActivityDeleteErrorMessage:{id:"be.api.appActivityDeleteErrorMessage",defaultMessage:"There was an error deleting this item."},commentCreateErrorMessage:{id:"be.api.commentCreateErrorMessage",defaultMessage:"There was an error creating this comment."},commentCreateConflictMessage:{id:"be.api.commentCreateConflictMessage",defaultMessage:"This comment already exists."},commentDeleteErrorMessage:{id:"be.api.commentDeleteErrorMessage",defaultMessage:"There was an error deleting this comment."},taskActionErrorTitle:{id:"be.api.taskActionErrorTitle",defaultMessage:"Error"},taskApproveErrorMessage:{id:"be.api.taskApproveErrorMessage",defaultMessage:"An error has occurred while approving this task. Please refresh the page and try again."},taskCompleteErrorMessage:{id:"be.api.taskCompleteErrorMessage",defaultMessage:"An error has occurred while completing this task. Please refresh the page and try again."},taskRejectErrorMessage:{id:"be.api.taskRejectErrorMessage",defaultMessage:"An error has occurred while rejecting this task. Please refresh the page and try again."},taskDeleteErrorMessage:{id:"be.api.taskDeleteErrorMessage",defaultMessage:"There was an error while deleting this task. Please refresh the page and try again."},taskCreateErrorMessage:{id:"be.api.taskCreateErrorMessage",defaultMessage:"An error occurred while creating this task. Please try again."},taskGroupExceedsLimitWarningMessage:{id:"be.api.taskGroupExceedsWarningTitle",defaultMessage:"One or more groups can not receive this task as a group size cannot exceed the limit of {max} assignees per group."}});t.a=o}}]);